# 结构与层叠

## 前言

屏幕是一个二维平面，然而 HTML 元素却是排列在三维坐标系中，x 为水平位置，y 为垂直位置，z 为屏幕由内向外方向的位置，我们在看屏幕的时候是沿着 z 轴方向从外向内的；由此，元素在用户视角就形成了层叠的关系，某个元素可能覆盖了其他元素也可能被其他元素覆盖；

![images](stacking01.png)

## 内容

- 什么是“层叠上下文”
- 什么是“层叠等级”
- 如何产生“层叠上下文”
- 什么是“层叠顺序”

### 一、什么是“层叠上下文”

层叠上下文(stacking context)，是 HTML 中一个三维的概念。在 CSS2.1 规范中，每个盒模型的位置是三维的，分别是平面画布上的`x轴`，`y轴`以及表示层叠的`z轴`。一般情况下，元素在页面上沿`x轴y轴`平铺，我们察觉不到它们在`z轴`上的层叠关系。而一旦元素发生堆叠，这时就能发现某个元素可能覆盖了另一个元素或者被另一个元素覆盖。

如果一个元素含有层叠上下文，(也就是说它是层叠上下文元素)，我们可以理解为这个元素在`Z轴`上就“高人一等”，最终表现就是它离屏幕观察者更近。

### 二、什么是“层叠等级”

**层叠等级**(层叠水平,Stacking Level)决定了同一个层叠上下文中元素在 z 轴上的显示顺序的**概念**；

- 普通元素的层叠等级优先由其所在的层叠上下文决定
- 层叠等级的比较只有在同一个层叠上下文元素中才有意义
- 在同一个层叠上下文中，层叠等级描述定义的是该层叠上下文中的元素在 Z 轴上的上下顺序

### 三、如何产生“层叠上下文”

层叠上下文也基本上是有一些特定的 CSS 属性创建的，一般有 3 种方法：

- 根元素`<html></html>`
- `position`值为`absolute | relative`，且`z-index`值不为`auto`
- `posistion`值为`fixed | sticky`
- `z-index`值不为`auto`的 flex 元素，即：父元素`display:flex | inline-flex`
- `opacity`属性值小于`1`的元素
- `transform`属性值不为`none`的元素
- `mix-blend-mode`属性值不`normal`的元素
- `filter`、`perspective`、
- `isolation`属性被设置为`isolate`的元素
- `will-change`中指定了任意 CSS 属性，即便你没有直接指定这些属性的值
- `-webkit-overflow-scrolling`属性被设置`touch`的元素

### 四、什么是“层叠顺序”

**层叠顺序**(层叠次序，堆叠顺序，Stacking Order)描述的是元素在同一个层叠上下文中的顺序**规则**，从层叠的底部开始，共有七种层叠顺序：

- **背景和边框**：
- **负 z-index 值**：
- **块级盒**：
- **浮动盒**：
- **行内盒**：
- **z-index:0**：
- **正 z-index 值**：

### 五、z-index 的理解

### 参考资料

- [彻底搞懂 CSS 层叠上下文、层叠等级、层叠顺序、z-index](https://juejin.im/post/5b876f86518825431079ddd6)
- [CSS 中重要的层叠概念](https://juejin.im/post/5ba4efe36fb9a05cf52ac192)
- 《CSS 世界》

## 联系作者

<div align="center">
    <p>
        平凡世界，贵在坚持。
    </p>
    <img :src="$withBase('/about/contact.png')" />
</div>
