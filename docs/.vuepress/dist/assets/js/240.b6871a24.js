(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{467:function(s,n,a){"use strict";a.r(n);var e=a(4),r=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"webpack-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack-配置","aria-hidden":"true"}},[s._v("#")]),s._v(" webpack 配置")]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("本人平时学习及收集内容，欢迎参入一起讨论。")]),s._v(" "),a("h2",{attrs:{id:"内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内容","aria-hidden":"true"}},[s._v("#")]),s._v(" 内容")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E4%B8%80%E3%80%81%E4%BB%8B%E7%BB%8D%E3%80%81%E5%AE%89%E8%A3%85%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"}},[s._v("介绍、安装及常用命令")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E4%BA%8C%E3%80%81%E6%9C%80%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE"}},[s._v("webpack 基本配置说明")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E4%B8%89%E3%80%81webpack%E9%85%8D%E7%BD%AE"}},[s._v("webpack 配置")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E5%9B%9B%E3%80%81%E4%BC%98%E5%8C%96"}},[s._v("优化")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E4%BA%94%E3%80%81%E5%8E%9F%E7%90%86"}},[s._v("原理")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E5%85%AD%E3%80%81%E6%89%8B%E5%86%99webpack%E6%8F%92%E4%BB%B6"}},[s._v("手写 webpack 插件")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E4%B8%83%E3%80%81%E6%89%8B%E5%86%99loader"}},[s._v("手写 loader")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#%E6%80%BB%E7%BB%93"}},[s._v("总结")])])]),s._v(" "),a("h3",{attrs:{id:"一、介绍、安装及常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、介绍、安装及常用命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 一、介绍、安装及常用命令")]),s._v(" "),a("ul",[a("li",[s._v("什么是 webpack")]),s._v(" "),a("li",[s._v("webpack 特点")]),s._v(" "),a("li",[s._v("webpack 安装")]),s._v(" "),a("li",[s._v("常用命令")])]),s._v(" "),a("h4",{attrs:{id:"_1-1-什么是-webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-什么是-webpack","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.1 什么是 webpack")]),s._v(" "),a("p",[s._v("自从出现模块化以后，大家可以将原本一坨代码分离到个个模块中，但是由此引发了一个问题。每个 JS 文件都需要从服务器去拿，由此会导致加载速度变慢。Webpack 最主要的目的就是为了解决这个问题，将所有小文件打包成一个或多个大文件，官网的图片很好的诠释了这个事情，除此之外，Webpack 也是一个能让你使用各种前端新技术的工具。")]),s._v(" "),a("p",[a("img",{attrs:{src:"webpack01.jpg",alt:"image"}})]),s._v(" "),a("p",[s._v("webpack 一共经历了 4 个版本，分别是 1、2、3、4，最新版本是 4，以下案例是基于 4 实践的")]),s._v(" "),a("h4",{attrs:{id:"_1-2-webpack-特点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-webpack-特点","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.2 webpack 特点")]),s._v(" "),a("ol",[a("li",[s._v("专注于处理模块化的项目，能做到开箱即用、一步到位；")]),s._v(" "),a("li",[s._v("可通过 Plugin 扩展，完整好用又不失灵活；")]),s._v(" "),a("li",[s._v("使用场景不局限于 web 开发；")]),s._v(" "),a("li",[s._v("社区庞大活跃，经常引入紧跟时代发展的新特性，能为大多数场景找到自己有的开源扩展；")]),s._v(" "),a("li",[s._v("良好的开发体验；")])]),s._v(" "),a("p",[s._v("——自来《深入浅出 webpack》")]),s._v(" "),a("h4",{attrs:{id:"_1-3-webpack-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-webpack-安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.3 webpack 安装")]),s._v(" "),a("p",[s._v("全局安装 webpack")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install -g webpack\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("局部安装 webpack")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("npm install --save-dev webpack\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_1-4-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-常用命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.4 常用命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("webpack -p 执行一次生成环境的编译（压缩）\nwebpack --watch 在开发时持续监控增量编译（很快）\nwebpack -d 让他生成SourceMaps\nwebpack --progress 显示编译进度\nwebpack --colors 显示静态资源的颜色\nwebpack --sort-modules-by, --sort-chunks-by, --sort-assets-by 将modules/chunks/assets进行列表排序\nwebpack --display-chunks 展示编译后的分块\nwebpack --display-reasons 显示更多引用模块原因\nwebapck --display-error-details 显示更多报错信息\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"二、最简单配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、最简单配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 二、最简单配置")]),s._v(" "),a("h4",{attrs:{id:"_2-1-webpack-相关参数介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-webpack-相关参数介绍","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1 webpack 相关参数介绍")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("entry")])])]),s._v(" "),a("p",[s._v("配置模块的入口，Entry 参数说明，类型可以是以下三种中的一种或者相互组合")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("例子")]),s._v(" "),a("th",[s._v("含义")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("string")]),s._v(" "),a("td",[s._v("'./app/entry'")]),s._v(" "),a("td",[s._v("入口模块的文件路径，可以相对路径")])]),s._v(" "),a("tr",[a("td",[s._v("array")]),s._v(" "),a("td",[s._v("['./app/entry1','./app/entry2']")]),s._v(" "),a("td",[s._v("入口模块的文件路径，可以是相对路径")])]),s._v(" "),a("tr",[a("td",[s._v("object")]),s._v(" "),a("td",[s._v("{a:['./app/entry-a'],b:['./app/entry-b1','./app/entry-b2']}")]),s._v(" "),a("td",[s._v("配置多个入口，每个入口生成一个 chunk")])])])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("output")])])]),s._v(" "),a("p",[s._v("配置如何输出最终想要的代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("output是一个object,里面包含一系列配置项\n\noutput.filename:'[name].js'  //输出文件的名称\n也可以使用hash、chunkhash、contenthash来命名，关于hash、chunkhash、contenthash区别可以参考https://www.cnblogs.com/tugenhua0707/p/9615822.html#_labe1_2\n\noutput.chunkFilename://chunkFilename 和上面的 filename 非常类似，但 chunkFilename 只用于指定在运行过程中生成的 Chunk 在输出时的文件名称，vue按需加载就可以使用这个参数\n\noutput.path：path .resolve( dirname, ’ dist [hash]’) //path 配置输出文件存放在本地的目录\noutput.publicPath:'https://cdn.example.com/assets/' //配置发布到线上资源的 URL 前缀\noutput.libraryTarget://配置以何种方式导出库，可选值var、commonjs、commonjs2、this、window、global\noutput.library://配置导出库的名称。\noutput.libraryExport: 配置要导出的模块中哪些子模块需要被导出\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("module")])])]),s._v(" "),a("p",[a("code",[s._v("rules")]),s._v("配置模块的读取和解析规则，通常用来配置 Loader。大致可以通过以下方式来完成")]),s._v(" "),a("ul",[a("li",[s._v("条件匹配:通过"),a("code",[s._v("test")]),s._v("、"),a("code",[s._v("include")]),s._v("、 "),a("code",[s._v("exclude")]),s._v("三个配置项来选中"),a("code",[s._v("Loader")]),s._v("要应用 规则的文件。")]),s._v(" "),a("li",[s._v("应用规则：对选中的文件通过 "),a("code",[s._v("use")]),s._v("配置项来应用"),a("code",[s._v("Loader")]),s._v("，可以只应用一个"),a("code",[s._v("Loader")]),s._v("或者按照从后往前的顺序应用一组 "),a("code",[s._v("Loader")]),s._v("，同时可以分别向"),a("code",[s._v("Loader")]),s._v("传入参数。")]),s._v(" "),a("li",[s._v("重置顺序:一组"),a("code",[s._v("Loader")]),s._v("的执行顺序默认是从右到左执行的，通过"),a("code",[s._v("enforce")]),s._v("选项可以将其中 一个"),a("code",[s._v("Loader")]),s._v("的执行顺序放到最前或者最后 。")])]),s._v(" "),a("p",[s._v("具体方法：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module:{\n    rules:[\n        {\n            //命中 JavaScript 文件\n            test: /\\.js$/，\n            //用 babel-loader 转换 JavaScript 文件\n            //?cacheDirectory 表示传给 babel-loader 的参数，用于缓存 babel 的编译结果，\n            use : [’ babel-loader?cacheDirectory ’],\n            //只命中 src 目录里的 JavaScript 文件，加快 Webpack 的搜索速度\n            include: path.resolve( dirname, ’ src ’)\n        },\n        {\n            //命中scss文件\n            test:/\\.scss$/,\n            //使用一组loader去处理scss文件\n            //处理顺序为从后到前，即先交给 sass-loader处理，再将结果交给 css-loader,最后交给 style-loader\n            use:['style-loader','css-loader','sass-loader'],\n            //排除node_modules目录下的文件\n            exclude: path.resolve( dirname, ’ node modules ’)\n        },\n        {\n            //对非文件采用file-loader加载\n            test:/\\.(gif|png|jpe?g|eot|woff|ttf|svg|pdf)$/,\n            use:['file-loader']\n        }\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("noParse")])])]),s._v(" "),a("p",[s._v("配置项可以让 Webpack 忽略对部分没采用模块化的文件的递归解析和处理，这样做的好处能提高构建性能。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    //使用正则表达式\nnoParse: /jquerylchartjs/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("注意，被忽略的文件里不应该包含"),a("code",[s._v("import")]),s._v("、"),a("code",[s._v("require")]),s._v("、"),a("code",[s._v("define")]),s._v("等模块化 语句，不 然会导致在构建出的代码中包含无法在浏览器环境下执行的模块化语句 。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("parse")])])]),s._v(" "),a("p",[a("code",[s._v("parser")]),s._v("属性可以更细粒度地配置 哪些模块语法被解析、哪些不被解析。同"),a("code",[s._v("noParse")]),s._v("配置项的区别在于，"),a("code",[s._v("parser")]),s._v("可以精确到 语法层 面，而"),a("code",[s._v("noParse")]),s._v("只能控制哪些文件不被解析。")]),s._v(" "),a("p",[a("code",[s._v("parser")]),s._v("的使用方法如下:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("module: {\n    rules : [\n        {\n        test: /\\.js♀/，\n        use: [ ’ babel-loader ’],\n        parser: {\n            amd: false， //禁用AMD\n            commonjs : false , //禁用 CommonJS\n            system : false, //禁用 SystemJS\n            harmony: false， //禁用 ES6 import/export\n            requireinclude:false,   //禁用require.include\n            requireEnsure: false,   //禁用require.ensure\n            requireContext:false,   //禁用require.context\n            browserify: false, //禁用 browserify requireJs : false, //禁用 requirejs:false\n            requireJs : false, //禁用 requirejs\n            }\n        }\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("resolve")])])]),s._v(" "),a("p",[s._v("配置寻找模块的规则")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("配置项通过别名来将原导入路径映射成一个新的导入路径\n\nresolve:{\n    alias:{\n        components:'./src/components/'\n    }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("mainFields")])])]),s._v(" "),a("p",[s._v("会根据"),a("code",[s._v("mainFields")]),s._v("的配 置去决定 优先采用哪份代码，")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mainFields : [’jsnext:main’,’browser’,’main’]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("extensions")])])]),s._v(" "),a("p",[s._v("Webpack 会自动带上后缀后去尝试访问文件是否存在。 resolve.extensions 用于配置在尝试过程中用到的后缀列表")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("extensions:[’.ts’,’.j5 ’,’.json’]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("plugins")])])]),s._v(" "),a("p",[s._v("配置扩展插件")]),s._v(" "),a("p",[s._v("plugins 配置项接收一个数组，数组里的每一项都是一个要使用 的 Plugin 的实例， Plugin 需要的参数通过构造函数传入,"),a("code",[s._v("mini-css-extract-plugin")]),s._v("、"),a("code",[s._v("clean-webpack-plugin")]),s._v("、"),a("code",[s._v("DllReferencePlugin")]),s._v("、"),a("code",[s._v("html-webpack-plugin")]),s._v("、"),a("code",[s._v("happyPack")]),s._v("、"),a("code",[s._v("webpack-parallel-uglify-plugin")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const ClearWebpackPlugin = require('clean-webpack-plugin');\n\nmodule.exports=[\n    plugins:[\n        new ClearWebpackPlugin(['dist'])\n    ]\n];\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[a("p",[a("strong",[s._v("DevServer")])]),s._v(" "),a("ul",[a("li",[a("code",[s._v("hot")]),s._v(",开启模块热替换功能后，将在不刷新整个页面的情况下通过用新模块替换老模块来做到实时预览")]),s._v(" "),a("li",[a("code",[s._v("inline")]),s._v(",依赖一个注入页面里的代理客户端，去接收来自 DevServer 的 命令并负责刷新网页的工作。")]),s._v(" "),a("li",[a("code",[s._v("contentBase")]),s._v(",配置 DevServerHTTP 服务器的文件根目录")])])])]),s._v(" "),a("h3",{attrs:{id:"三、webpack-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、webpack-配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 三、webpack 配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const path = require('path');\nconst webpack = require('webpack');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\nconst MiniCssExtractPlugin = require(\"mini-css-extract-plugin\");\nconst ClearWebpackPlugin = require('clean-webpack-plugin');\nconst DllReferencePlugin = require('webpack/lib/DllReferencePlugin');\nconst ParallelUglifyPlugin = require('webpack-parallel-uglify-plugin');\nconst HappyPack = require('happypack');\nmodule.exports = {\n    entry: './app/index/app.js', //支持多个参数，string|array|object\n    output: {\n        filename: ' [name].js', //输出文件名称\n        path: path.resolve(__dirname, './dist'), //输出文件的目标路径\n        publicPath: '/' //构建文件的输出目录\n    },\n    devServer: { //DevServer相关的配置\n        contentBase: path.join(__dirname, 'dist'),\n        compress: true, //压缩\n        port: 8888, //端口号\n        open: true, //第一次打开浏览器\n        hot: true, //是否监听\n        publicPath: \"/\" //访问的目录\n    },\n    module: {\n        rules: [{\n                test: /\\.js$/,\n                use: [' babel-loader'],\n                parser: {\n                    amd: true, //禁用AMD\n                    commonjs: true, //禁用 CommonJS\n                    system: false, //禁用 SystemJS\n                    harmony: true, //禁用 ES6 import/export\n                    requireinclude: false, //禁用require.include\n                    requireEnsure: false, //禁用require.ensure\n                    requireContext: false, //禁用require.context\n                    browserify: false, //禁用 browserify requireJs : false, //禁用 requirejs:false\n                    requireJs: false, //禁用 requirejs\n                }\n            },\n            {\n                // 用正则去匹配要用该 loader 转换的 CSS 文件\n                test: /\\.css$/,\n                use: [{\n                    loader: MiniCssExtractPlugin.loader,\n                }, {\n                    loader: path.resolve('./loaders.js'),\n                    options: {\n                        test: 1\n                    }\n                }, {\n                    loader: 'css-loader?minimize',\n                }, {\n                    loader: 'postcss-loader',\n                    options: {\n                        ident: 'postcss',\n                        plugins: [\n                            require('postcss-cssnext')(),\n                            require('cssnano')(),\n                            require('postcss-sprites')()\n                        ]\n                    }\n                }],\n            }, {\n                //图片处理\n                test: /\\.(png|svg|jpg|gif)$/,\n                use: [{\n                    loader: 'url-loader',\n                    options: {\n                        limit: 10000,\n                        name: '[name].[ext]'\n                    }\n                }]\n            }\n        ]\n    },\n    resolve: {\n        modules: [\n            // 模块的查找目录\n            \"node_modules\",\n            path.resolve(__dirname, \"app\")\n        ],\n        extensions: ['.js', '.json', '.vue', '.css'],\n        alias: { //模块别名列表\n            'module': 'new-module'\n        }\n    },\n    devtool: 'source-map', //sourcemap\n    plugins: [ //插件部分\n        new ClearWebpackPlugin(['dist']),\n        new MiniCssExtractPlugin({\n            // Options similar to the same options in webpackOptions.output\n            // both options are optional\n            filename: `[name]_[contenthash:8].css`,\n            chunkFilename: '[name]_[contenthash:8].css'\n        }),\n        // 告诉webpack使用了哪些第三方库代码\n        new DllReferencePlugin({\n            // jquery 映射到json文件上去\n            manifest: require('./dill/jquery.manifest.json')\n        }),\n        new ParallelUglifyPlugin({\n            // 传递给 UglifyJS的参数如下：\n            uglifyJS: {\n                output: {\n                    /*\n                     是否输出可读性较强的代码，即会保留空格和制表符，默认为输出，为了达到更好的压缩效果，\n                     可以设置为false\n                    */\n                    beautify: false,\n                    /*\n                     是否保留代码中的注释，默认为保留，为了达到更好的压缩效果，可以设置为false\n                    */\n                    comments: false\n                },\n                compress: {\n                    /*\n                     是否在UglifyJS删除没有用到的代码时输出警告信息，默认为输出，可以设置为false关闭这些作用\n                     不大的警告\n                    */\n                    warnings: false,\n\n                    /*\n                     是否删除代码中所有的console语句，默认为不删除，开启后，会删除所有的console语句\n                    */\n                    drop_console: true,\n\n                    /*\n                     是否内嵌虽然已经定义了，但是只用到一次的变量，比如将 var x = 1; y = x, 转换成 y = 5, 默认为不\n                     转换，为了达到更好的压缩效果，可以设置为false\n                    */\n                    collapse_vars: true,\n\n                    /*\n                     是否提取出现了多次但是没有定义成变量去引用的静态值，比如将 x = 'xxx'; y = 'xxx'  转换成\n                     var a = 'xxxx'; x = a; y = a; 默认为不转换，为了达到更好的压缩效果，可以设置为false\n                    */\n                    reduce_vars: true\n                }\n            }\n        }),\n        //将js自动插入到html里\n        new HtmlWebpackPlugin({\n            template: './views/index.html',\n            filename: 'index.html',\n        }),\n        new webpack.HotModuleReplacementPlugin() //引入热更新插件\n    ]\n};\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br"),a("span",{staticClass:"line-number"},[s._v("148")]),a("br")])]),a("h3",{attrs:{id:"四、优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、优化","aria-hidden":"true"}},[s._v("#")]),s._v(" 四、优化")]),s._v(" "),a("p",[s._v("优化主要是针对打包速度跟打包大小优化，主要包含以下方面")]),s._v(" "),a("ol",[a("li",[s._v("对于 Webpack4，打包项目使用 production 模式，这样会自动开启代码压缩")]),s._v(" "),a("li",[s._v("使用 ES6 模块来开启 tree shaking，这个技术可以移除没有使用的代码")]),s._v(" "),a("li",[s._v("优化图片，对于小图可以使用 base64 的方式写入文件中")]),s._v(" "),a("li",[s._v("按照路由拆分代码，实现按需加载")]),s._v(" "),a("li",[s._v("给打包出来的文件名添加哈希，实现浏览器缓存文件(主要采用 chunkFilename)")])]),s._v(" "),a("h4",{attrs:{id:"_4-1-打包速度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-打包速度","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.1 打包速度")]),s._v(" "),a("ol",[a("li",[s._v("减少文件搜索范围，比如通过另名，loader 的 test,include & exclude")]),s._v(" "),a("li",[s._v("resolve.module，配置 webpack 去哪些目录下妙手第三方模块")]),s._v(" "),a("li",[s._v("resolve.aslias 配置，通过另外来将原导入路径映射成一个新的导入路径")]),s._v(" "),a("li",[s._v("Webpack4 默认压缩并行")]),s._v(" "),a("li",[s._v("Happypack 并发调用\n"),a("ul",[a("li",[s._v("threads:开启几个子进程去处理这一类型的文件，默认是 3 个，必须整数")]),s._v(" "),a("li",[s._v("verbose:是否允许 happypack 输出日志，默认是 true")]),s._v(" "),a("li",[s._v("threadpool:代表共享进程池，即多个 happypack 实例都使用同一个共享进程池中的子进程去处理任务，以防止资源占用过多")])])]),s._v(" "),a("li",[s._v("Babel 使用缓存编译，主要 loader 参数后面增加 cacheDirectory，关于"),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/NRZQI-Md0dqNAGY96qsn-A",target:"_blank",rel:"noopener noreferrer"}},[s._v("babel 编译原理"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("使用 DllPlugin 和 DllReferencePlugin，这两个跟 CommonsChunkPlugin（webpack3 中的，webpack4 中使用 SplitChunksPlugin）有一些区别，主要区别如下\n"),a("ul",[a("li",[s._v("CommonsChunkPlugin 插件每次打包的时候还是会去处理一些第三方依赖库，只是它能把第三方库文件和我们的代码分开掉，生成一个独立的 js 文件，但它不能提高打包速度。")]),s._v(" "),a("li",[s._v("DLLPlugin 它能把第三方库代码分离开，并且每次文件更改的时候，它只会==打包该项目自身==的代码。所以打包速度会更快。")])])])]),s._v(" "),a("p",[s._v("介绍 DllPlugin 插件跟 DllReferencePlugin 插件")]),s._v(" "),a("ul",[a("li",[s._v("DllPlugin 插件 : 用于打包出一个个单独的动态链接库文件 。")]),s._v(" "),a("li",[s._v("DllReferencePlugin 插件:用于在主要的配置文件中引入 DllP!ugin 插件打包好的动态链接库文件。")])]),s._v(" "),a("p",[s._v("具体配置如下：")]),s._v(" "),a("p",[a("code",[s._v("webpack.dll.config.js")]),s._v("配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const path = require('path');\nconst DllPlugin = require('webpack/lib/DllPlugin');\n\nmodule.exports = {\n    // 入口文件\n    entry: {\n        // 项目中用到该两个依赖库文件\n        jquery: ['./libs/jquery'],\n        // echarts: ['echarts']\n    },\n    // 输出文件\n    output: {\n        // 文件名称\n        filename: '[name].dll.js',\n        // 将输出的文件放到dist目录下\n        path: path.resolve(__dirname, 'dill'),\n        /*\n         存放相关的dll文件的全局变量名称，比如对于jquery来说的话就是 _dll_jquery, 在前面加 _dll\n         是为了防止全局变量冲突。\n        */\n        library: '_dll_[name]'\n    },\n    plugins:[\n        // 使用插件 DllPlugin\n    new DllPlugin({\n        /*\n         该插件的name属性值需要和 output.library保存一致，该字段值，也就是输出的 manifest.json文件中name字段的值。\n         比如在jquery.manifest文件中有 name: '_dll_jquery'\n        */\n        name: '_dll_[name]',\n\n        /* 生成manifest文件输出的位置和文件名称 */\n        path: path.join(__dirname, 'dill', '[name].manifest.json')\n      })\n    ]\n};\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[a("code",[s._v("webpack.config.js")]),s._v("配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const DllReferencePlugin = require('webpack/lib/DllReferencePlugin');\n\n{\n    plugins:\n    [\n        // 告诉webpack使用了哪些第三方库代码\n        new DllReferencePlugin({\n        // jquery 映射到json文件上去\n        manifest: require('./dill/jquery.manifest.json')\n        })\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"五、原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、原理","aria-hidden":"true"}},[s._v("#")]),s._v(" 五、原理")]),s._v(" "),a("h4",{attrs:{id:"_5-1-webpack-运行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-webpack-运行流程","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.1 webpack 运行流程")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("webpack 事件流")])])]),s._v(" "),a("p",[s._v("Webpack 就像一条生产线，要经过一系列处理流程后才能将源文件转换成输出结果。 这条生产线上的每个处理流程的职责都是单一的，多个流程之间有存在依赖关系，只有完成当前处理后才能交给下一个流程去处理。 插件就像是一个插入到生产线中的一个功能，在特定的时机对生产线上的资源做处理。 Webpack 通过 "),a("a",{attrs:{href:"https://juejin.im/post/5abf33f16fb9a028e46ec352",target:"_blank",rel:"noopener noreferrer"}},[s._v("Tapable"),a("OutboundLink")],1),s._v(" 来组织这条复杂的生产线。 Webpack 在运行过程中会广播事件，插件只需要监听它所关心的事件，就能加入到这条生产线中，去改变生产线的运作。 Webpack 的事件流机制保证了插件的有序性，使得整个系统扩展性很好。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("webpack 运行流程详解")])])]),s._v(" "),a("p",[s._v("Webpack 的运行流程是一个串行的过程，从启动到结束会依次执行以下流程。")]),s._v(" "),a("ul",[a("li",[s._v("初始化参数：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数。")]),s._v(" "),a("li",[s._v("开始编译：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，通过执行对象的 run 方法开始执行编译。")]),s._v(" "),a("li",[s._v("确定入口：根据配置中的 entry 找出所有入口文件。")]),s._v(" "),a("li",[s._v("编译模块：从入口文件出发，调用所有配置的 loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤走到所有入口依赖的文件都经过了本步骤的处理。")]),s._v(" "),a("li",[s._v("完成模块编译：在经过第 4 步使用 loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容及它们之间的依赖关系。")]),s._v(" "),a("li",[s._v("输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再将每个 Chunk 转换成一个单独的文件加入输出列表中，这是可以修改输出内容的最后机会。")]),s._v(" "),a("li",[s._v("输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，将文件的内容写入文件系统中。")])]),s._v(" "),a("p",[s._v("流程图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"webpack02.jpg",alt:"01"}})]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("抽象语法树（AST）")])])]),s._v(" "),a("blockquote",[a("p",[s._v("在计算机科学中，抽象语法树（Abstract Syntax Tree，AST），或简称语法树（Syntax tree），是源代码语法结构的一种抽象表示。它以树状的形式表现编程语言的语法结构，树上的每个节点都表示源代码中的一种结构。之所以说语法是“抽象”的，是因为这里的语法并不会表示出真实语法中出现的每个细节。比如，嵌套括号被隐含在树的结构中，并没有以节点的形式呈现；而类似于 if-condition-then 这样的条件跳转语句，可以使用带有两个分支的节点来表示。")])]),s._v(" "),a("p",[s._v("实际上一段代码经过编译器的词分析、语法分析等阶段之后，会生成一个树状结构的“抽象语法树（AST）”，该语法树的每一个节点都对应着代码当中不同含义片段。")]),s._v(" "),a("p",[s._v("解释器是将 AST 翻译成目标语言并运行的工具。")]),s._v(" "),a("h3",{attrs:{id:"六、手写-webpack-插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、手写-webpack-插件","aria-hidden":"true"}},[s._v("#")]),s._v(" 六、手写 webpack 插件")]),s._v(" "),a("ul",[a("li",[s._v("调用插件 apply 函数传入 compiler 对象")]),s._v(" "),a("li",[s._v("通过 compiler 对象监听")])]),s._v(" "),a("p",[s._v("插件代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('//@file: plugins/myplugin.js\nclass myPlugin {\n    constructor(options){\n        //用户自定义配置\n        this.options = options\n        console.log(this.options)\n    }\n    apply(compiler) {\n        console.log("This is my first plugin.")\n    }\n}\n\nmodule.exports = myPlugin\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("webpack 代码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const MyPlugin = require('./plugins/myplugin-4.js')\n\nmodule.exports = {\n    ......,\n    plugins: [\n        new MyPlugin(\"Plugin is instancing.\")\n    ]\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("具体参数可以参考《深入浅出 webpack》")]),s._v(" "),a("h3",{attrs:{id:"七、手写-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七、手写-loader","aria-hidden":"true"}},[s._v("#")]),s._v(" 七、手写 loader")]),s._v(" "),a("ol",[a("li",[s._v("获得 loader 的 options，是通过"),a("code",[s._v("require (’ loader-utils ’);")])]),s._v(" "),a("li",[s._v("返回其他结果，是调用"),a("code",[s._v("callback")])]),s._v(" "),a("li",[s._v("缓存加速，调用 this.cacheable(false);")])]),s._v(" "),a("p",[s._v("具体参数可以参考《深入浅出 webpack》")]),s._v(" "),a("h4",{attrs:{id:"_7-1-loader-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-loader-文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 7.1 loader 文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const loaderUtils = require('loader-utils');\n\nmodule.exports = function (content) {\n    // 获取用户配置的options 同步\n    const options=loaderUtils.getOptions(this);\n    console.log('***options***',options);\n    this.callback(null,'{}'+content);\n    return '{};'+content;\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"_7-2-webpack-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-webpack-配置文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 7.2 webpack 配置文件")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("{\n    test: /\\.js$/,\n    exclude: /node_modules/,\n       use: {\n           //这里是我的自定义loader的存放路径\n           loader: path.resolve('./loaders/index.js'),\n           options: {\n              test: 1\n           }\n       }\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结","aria-hidden":"true"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("webpack 打包配置相对比较复杂，目前介绍应该可以满常规需求。")]),s._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ul",[a("li",[s._v("《深入浅出 webpack》")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/uc4fVViv4u86TTX2XsMgFA",target:"_blank",rel:"noopener noreferrer"}},[s._v("【第 1617 期】Webpack 是怎样运行的?"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/yanlele/node-index/blob/master/book/11%E3%80%81%E6%B7%B1%E5%85%A5webpack%E5%B7%A5%E7%A8%8B%E5%8C%96/01%E3%80%81%E7%94%B1%E6%B5%85%E5%85%A5%E6%B7%B1Webpack/README.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("由浅入深 Webpack"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/webpack-china/awesome-webpack-cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("搜罗一切 webpack 的好文章好工具"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5cea1e1ae51d4510664d1652",target:"_blank",rel:"noopener noreferrer"}},[s._v("关于 webpack4 的 14 个知识点,童叟无欺"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/R9hyFWIvRlzHj9owa-aDjA",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack 优化——将你的构建效率提速翻倍"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzI0MzIyMDM5Ng==&mid=2649825759&idx=1&sn=726279d3dfc2ea0b6ba34788517753ad&chksm=f175eb1cc602620a66821baedcb2663e393f7ae4857e8daf6d57e4c436f9a7297a555d0e4750&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack 性能优化总结大全"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/b45oLYScG8L40iVlg7qG7g",target:"_blank",rel:"noopener noreferrer"}},[s._v("一文搞懂 Webpack 多入口配置"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5de06aa851882572d672c1ad",target:"_blank",rel:"noopener noreferrer"}},[s._v("一步步从零开始用 webpack 搭建一个大型项目"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5d518b4de51d4561cc25f013",target:"_blank",rel:"noopener noreferrer"}},[s._v("【Cute-Webpack】Webpack4 入门手册（共 18 章）"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/luoxue-victor/webpack-box",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack 工程师的自我修养"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/zy8GfmfM8tg6uiKAhItGIg",target:"_blank",rel:"noopener noreferrer"}},[s._v("【第 619 期】如何 10 倍提高你的 Webpack 构建效率"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5df884ad6fb9a0164e7f979d",target:"_blank",rel:"noopener noreferrer"}},[s._v("Webpack 深入浅出之公司级分享总结(内附完整 ppt)"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://juejin.im/post/5de87444518825124c50cd36",target:"_blank",rel:"noopener noreferrer"}},[s._v("2020 年了,再不会 webpack 敲得代码就不香了(近万字实战)"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"联系作者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#联系作者","aria-hidden":"true"}},[s._v("#")]),s._v(" 联系作者")]),s._v(" "),a("div",{attrs:{align:"center"}},[a("p",[s._v("\n        平凡世界，贵在坚持。\n    ")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/about/contact.png")}})])])}),[],!1,null,null,null);n.default=r.exports}}]);