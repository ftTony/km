(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{333:function(r,e,t){"use strict";t.r(e);var a=t(4),_=Object(a.a)({},(function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[t("h1",{attrs:{id:"web-worker-学习"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#web-worker-学习","aria-hidden":"true"}},[r._v("#")]),r._v(" web worker 学习")]),r._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[r._v("#")]),r._v(" 前言")]),r._v(" "),t("p",[r._v("本人平时学习及收集内容，欢迎参入一起讨论。")]),r._v(" "),t("h2",{attrs:{id:"内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内容","aria-hidden":"true"}},[r._v("#")]),r._v(" 内容")]),r._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E4%B8%80%E3%80%81web-worker-%E4%BB%8B%E7%BB%8D"}},[r._v("Web Worker 介绍")])]),r._v(" "),t("li",[t("a",{attrs:{href:"#%E4%BA%8C%E3%80%81web-worker-%E5%88%86%E7%B1%BB"}},[r._v("Web Worker 分类")])]),r._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%89%E3%80%81web-worker-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"}},[r._v("Web Worker 工作原理")])]),r._v(" "),t("li",[t("a",{attrs:{href:"#%E5%9B%9B%E3%80%81web-worker-%E4%BD%BF%E7%94%A8"}},[r._v("Web Worker 使用")])])]),r._v(" "),t("h3",{attrs:{id:"一、web-worker-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、web-worker-介绍","aria-hidden":"true"}},[r._v("#")]),r._v(" 一、Web Worker 介绍")]),r._v(" "),t("p",[r._v("Web Worker 使得一个 Web 应用程序可以在与主执行纯种分享的后台线程中运行一个脚本操作。这样做的好处是可以在一个单独的线程中执行费时的处理任务，从而允许主（通常是 UI）线程运行而不被阻塞。")]),r._v(" "),t("p",[r._v("它的作用就是给 JS 创造多线程运行环境，允许主线程创建 worker 线程，分配任务给后者，主线程运行的同时 worker 线程也在运行，相互不干扰，在 worker 线程运行结束后把结果返回给主线程。这样做的好处是主线程可以把计算密集型或高延迟的任务交给 worker 线程执行，这样主线程就会变得轻松，不会被阻塞或拖慢。这并不意味着 JS 语言本身支持了多线程能力，而是浏览器作为宿主环境提供了 JS 一个多线程运行的环境。")]),r._v(" "),t("p",[r._v("不过因为 worker 一旦新建，就会一直运行，不会被主线程的活动打断，这样有利于随时响应主线程的通性，但是也会造成资源的浪费，所以不应过度使用，用完注意关闭。或者说：如果 worker 无实例引用，该 worker 空闲后立即会被关闭；如果 worker 实列引用不为 0，该 worker 空闲也不会被关闭。")]),r._v(" "),t("p",[t("strong",[r._v("兼容性")])]),r._v(" "),t("table",[t("thead",[t("tr",[t("th",[r._v("Browser")]),r._v(" "),t("th",[r._v("IE")]),r._v(" "),t("th",[r._v("Edge")]),r._v(" "),t("th",[r._v("FireFox")]),r._v(" "),t("th",[r._v("Chrome")]),r._v(" "),t("th",[r._v("Safari")])])]),r._v(" "),t("tbody",[t("tr",[t("td",[r._v("version")]),r._v(" "),t("td",[r._v("10+")]),r._v(" "),t("td",[r._v("12+")]),r._v(" "),t("td",[r._v("3.5+")]),r._v(" "),t("td",[r._v("4+")]),r._v(" "),t("td",[r._v("4+")])])])]),r._v(" "),t("h3",{attrs:{id:"二、web-worker-分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、web-worker-分类","aria-hidden":"true"}},[r._v("#")]),r._v(" 二、Web Worker 分类")]),r._v(" "),t("p",[r._v("Web Worker 一共包含了 3 种类型的 Worker：")]),r._v(" "),t("ul",[t("li",[r._v("Delicated Worker（专用 Worker）")]),r._v(" "),t("li",[r._v("Shared Worker（共享 Worker）")]),r._v(" "),t("li",[r._v("Service Worker（服务 Worker）")])]),r._v(" "),t("h4",{attrs:{id:"_2-1-delicated-worker（专用-worker）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-delicated-worker（专用-worker）","aria-hidden":"true"}},[r._v("#")]),r._v(" 2.1 Delicated Worker（专用 Worker）")]),r._v(" "),t("p",[r._v("Dedicated Worker 由主线程实例化且只能与它通信。")]),r._v(" "),t("h4",{attrs:{id:"_2-2-shared-worker（共享-worker）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-shared-worker（共享-worker）","aria-hidden":"true"}},[r._v("#")]),r._v(" 2.2 Shared Worker（共享 Worker）")]),r._v(" "),t("p",[r._v("Shared Worker 可以被同一域（浏览器中不同的 tab、iframe 或其他 Shared Worker）下的所有线程访问。")]),r._v(" "),t("h4",{attrs:{id:"_2-3-service-worker（服务-worker）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-service-worker（服务-worker）","aria-hidden":"true"}},[r._v("#")]),r._v(" 2.3 Service Worker（服务 Worker）")]),r._v(" "),t("p",[r._v("Service Worker 是一个事件驱动型 Worker，它的初始化注册需要网页/站点的 origin 和路径信息。一个注册好的 Service Worker 可以控制相关网页/网站的导航、资源请求以及进行粒度化的资源缓存操作")]),r._v(" "),t("h3",{attrs:{id:"三、web-worker-工作原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、web-worker-工作原理","aria-hidden":"true"}},[r._v("#")]),r._v(" 三、web worker 工作原理")]),r._v(" "),t("h3",{attrs:{id:"四、web-worker-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、web-worker-使用","aria-hidden":"true"}},[r._v("#")]),r._v(" 四、web worker 使用")]),r._v(" "),t("h4",{attrs:{id:"_4-1-限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-限制","aria-hidden":"true"}},[r._v("#")]),r._v(" 4.1 限制")]),r._v(" "),t("p",[r._v("worker 线程的使用有一些注意点")]),r._v(" "),t("ol",[t("li",[r._v("同源限制 worker 线程执行的脚本文件必须和主线程的脚本文件同源，这是当然的了，总不能允许 worker 线程到别人电脑上到处读文件吧")]),r._v(" "),t("li",[r._v("文件限制 为了安全，worker 线程无法读取本地文件，它所加载的脚本必须来自网络，且需要与主线程的脚本同源")]),r._v(" "),t("li",[r._v("DOM 操作限制 worker 线程在与主线程的 window 不同的另一个全局上下文中运行，其中无法读取主线程所在网页的 DOM 对象，也不能获取 "),t("code",[r._v("document")]),r._v("、 "),t("code",[r._v("window")]),r._v("等对象，但是可以获取 "),t("code",[r._v("navigator")]),r._v("、 "),t("code",[r._v("location(只读)")]),r._v("、"),t("code",[r._v("XMLHttpRequest")]),r._v("、 "),t("code",[r._v("setTimeout")]),r._v("族等浏览器 API。")]),r._v(" "),t("li",[r._v("通信限制 worker 线程与主线程不在同一个上下文，不能直接通信，需要通过 postMessage 方法来通信。")]),r._v(" "),t("li",[r._v("脚本限制 worker 线程不能执行"),t("code",[r._v("alert")]),r._v("、"),t("code",[r._v("confirm")]),r._v("，但可以使用"),t("code",[r._v("XHLHttpRequest")]),r._v("对象发出 ajax 请求。")])]),r._v(" "),t("h4",{attrs:{id:"_4-2-实战场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-实战场景","aria-hidden":"true"}},[r._v("#")]),r._v(" 4.2 实战场景")]),r._v(" "),t("p",[t("strong",[r._v("加密数据")])]),r._v(" "),t("p",[r._v("有些加解密的算法比较复杂，或者在加解密很多数据的时候，这会非常耗费计算资源，导致 UI 线程无响应，因此这是使用 Web Worker 的好时机，使用 Worker 线程可以让用户更加无缝的操作 UI。")]),r._v(" "),t("p",[t("strong",[r._v("预取数据")])]),r._v(" "),t("p",[r._v("有时候为了提升数据加载速度，可以提前使用 Worker 线程获取数据，因为 Worker 线程是可以是用 "),t("code",[r._v("XMLHttpRequest")]),r._v(" 的。")]),r._v(" "),t("p",[t("strong",[r._v("预渲染")])]),r._v(" "),t("p",[r._v("在某些渲染场景下，比如渲染复杂的 canvas 的时候需要计算的效果比如反射、折射、光影、材料等，这些计算的逻辑可以使用 Worker 线程来执行，也可以使用多个 Worker 线程，这里有个射线追踪的示例。")]),r._v(" "),t("p",[t("strong",[r._v("复杂数据处理场景")])]),r._v(" "),t("p",[r._v("某些检索、排序、过滤、分析会非常耗费时间，这时可以使用 Web Worker 来进行，不占用主线程。")]),r._v(" "),t("p",[t("strong",[r._v("预加载图片")])]),r._v(" "),t("p",[r._v("有时候一个页面有很多图片，或者有几个很大的图片的时候，如果业务限制不考虑屋架载，也可以使用 Web Worker 来加载图片")]),r._v(" "),t("h3",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料","aria-hidden":"true"}},[r._v("#")]),r._v(" 参考资料")]),r._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://mp.weixin.qq.com/s/3MhSJoATeyHn3d96d3M3Sw",target:"_blank",rel:"noopener noreferrer"}},[r._v("Web Worker 的内部构造以及 5 种你应当使用它的场景"),t("OutboundLink")],1)]),r._v(" "),t("li",[t("a",{attrs:{href:"https://mp.weixin.qq.com/s/_ymkF6-Cc8i9A40WEOwMjQ",target:"_blank",rel:"noopener noreferrer"}},[r._v("前端 Web Workers 到底是什么"),t("OutboundLink")],1)])]),r._v(" "),t("h2",{attrs:{id:"联系作者"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#联系作者","aria-hidden":"true"}},[r._v("#")]),r._v(" 联系作者")]),r._v(" "),t("div",{attrs:{align:"center"}},[t("p",[r._v("\n        平凡世界，贵在坚持。\n    ")]),r._v(" "),t("img",{attrs:{src:r.$withBase("/about/contact.png")}})])])}),[],!1,null,null,null);e.default=_.exports}}]);