(window.webpackJsonp=window.webpackJsonp||[]).push([[242],{502:function(e,n,s){"use strict";s.r(n);var r=s(13),a=Object(r.a)({},(function(){var e=this,n=e.$createElement,s=e._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"错误监控"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误监控"}},[e._v("#")]),e._v(" 错误监控")]),e._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),s("p",[e._v("本人平时学习及收集内容，欢迎参入一起讨论。")]),e._v(" "),s("h2",{attrs:{id:"内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内容"}},[e._v("#")]),e._v(" 内容")]),e._v(" "),s("ul",[s("li",[e._v("为什么要处理异常?")]),e._v(" "),s("li",[e._v("需要处理哪些异常？")]),e._v(" "),s("li",[e._v("错误监控的方法")])]),e._v(" "),s("h3",{attrs:{id:"一、为什么要处理异常"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、为什么要处理异常"}},[e._v("#")]),e._v(" 一、为什么要处理异常?")]),e._v(" "),s("p",[e._v("异常是不可控的，会影响最终的呈现结果，但是我们有充分的理由去做这样的事件。")]),e._v(" "),s("ul",[s("li",[e._v("增强用户体验；")]),e._v(" "),s("li",[e._v("远程定位问题；")]),e._v(" "),s("li",[e._v("未雨绸缪，及早发现问题；")]),e._v(" "),s("li",[e._v("无法复线问题，尤其是移动端，机型，系统都是问题；")]),e._v(" "),s("li",[e._v("完善的前端方案，前端监控系统；")])]),e._v(" "),s("h3",{attrs:{id:"二、需要处理哪些异常？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、需要处理哪些异常？"}},[e._v("#")]),e._v(" 二、需要处理哪些异常？")]),e._v(" "),s("p",[e._v("对于前端来说，我们可以做的异常捕获还真不少，总结一下，大概如下：")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("JS")]),e._v("语法错误、代码异常")]),e._v(" "),s("li",[s("code",[e._v("Ajax")]),e._v("请求异常")]),e._v(" "),s("li",[e._v("静态资源加载异常")]),e._v(" "),s("li",[s("code",[e._v("Promise")]),e._v("异常")]),e._v(" "),s("li",[s("code",[e._v("Iframe")]),e._v("异常")]),e._v(" "),s("li",[e._v("跨域"),s("code",[e._v("Script error")])]),e._v(" "),s("li",[e._v("崩溃和卡顿")])]),e._v(" "),s("h3",{attrs:{id:"三、错误监控的方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、错误监控的方法"}},[e._v("#")]),e._v(" 三、错误监控的方法")]),e._v(" "),s("ul",[s("li",[e._v("try-catch")]),e._v(" "),s("li",[e._v("onerror")]),e._v(" "),s("li",[e._v("监听 error 事件")]),e._v(" "),s("li",[e._v("unhandledrejection")])]),e._v(" "),s("h4",{attrs:{id:"_3-1-try-catch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-try-catch"}},[e._v("#")]),e._v(" 3.1 try-catch")]),e._v(" "),s("p",[s("code",[e._v("try-catch")]),e._v("只能捕获到同步的运行时错误，对语法和异步错误无能为力，捕获不到。")]),e._v(" "),s("p",[s("strong",[e._v("1. 同步运行时的错误：")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("try {\n  let name = 'jartto';\n  console.log(nam);\n} catch(e) {\n  console.log('捕获到异常：',e);\n}\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("输出：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("捕获到异常： ReferenceError: nam is not defined\n    at <anonymous>:3:15\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[s("strong",[e._v("2. 不能捕获到语法错误")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("try {\n  let name = 'jartto;\n  console.log(nam);\n} catch(e) {\n\n  console.log('捕获到异常：',e);\n}\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("输出：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Uncaught SyntaxError: Invalid or unexpected token\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("strong",[e._v("3. 异步错误")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("try {\n  setTimeout(() => {\n    undefined.map(v => v);\n  }, 1000)\n} catch(e) {\n  console.log('捕获到异常：',e);\n}\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("输出")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Uncaught TypeError: Cannot read property 'map' of undefined\n    at setTimeout (<anonymous>:3:11)\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h4",{attrs:{id:"_3-2-window-onerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-window-onerror"}},[e._v("#")]),e._v(" 3.2 window.onerror")]),e._v(" "),s("p",[s("strong",[e._v("1. 同步")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("window.onerror = function(message, source, lineno, colno, error) {\n// message：错误信息（字符串）。\n// source：发生错误的脚本URL（字符串）\n// lineno：发生错误的行号（数字）\n// colno：发生错误的列号（数字）\n// error：Error对象（对象）\nconsole.log('捕获到异常：',{message, source, lineno, colno, error});\n}\nJartto;\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])]),s("p",[e._v("捕获到了异常：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("VM243:9 Uncaught ReferenceError: Jartto is not defined\n    at <anonymous>:9:1\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[s("strong",[e._v("2. 语法错误")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("window.onerror = function(message, source, lineno, colno, error) {\nconsole.log('捕获到异常：',{message, source, lineno, colno, error});\n}\nlet name = 'Jartto\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("输出结果：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Uncaught SyntaxError: Invalid or unexpected token\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("strong",[e._v("3. 异步")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("window.onerror = function(message, source, lineno, colno, error) {\n    console.log('捕获到异常：',{message, source, lineno, colno, error});\n}\nsetTimeout(() => {\n    Jartto;\n});\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("输出结果：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('捕获到异常： {message: "Uncaught ReferenceError: Jartto is not defined", source: "http://127.0.0.1:8001/", lineno: 36, colno: 5, error: ReferenceError: Jartto is not defined\n    at setTimeout (http://127.0.0.1:8001/:36:5)}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[s("strong",[e._v("4. 网络请求异常")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<script>\nwindow.onerror = function(message, source, lineno, colno, error) {\n    console.log('捕获到异常：',{message, source, lineno, colno, error});\n    return true;\n}\n<\/script>\n<img src=\"./jartto.png\">\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("不论是静态资源异常，或者接口异常，错误都无法捕获到。")]),e._v(" "),s("p",[s("strong",[e._v("结论")])]),e._v(" "),s("p",[s("code",[e._v("onerror")]),e._v("最好写在所有"),s("code",[e._v("JS")]),e._v("脚本的前面，否则有可能捕获不到错误；")]),e._v(" "),s("p",[s("code",[e._v("window.onerror")]),e._v("函数只有在返回"),s("code",[e._v("true")]),e._v("的时候，异常才不会向上抛出，否则即使是知道异常的发生控制台还是会显示"),s("code",[e._v("Uncaught Error: xxxxx")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("window.onerror = function(message, source, lineno, colno, error) {\n    console.log('捕获到异常：',{message, source, lineno, colno, error});\n    return true;\n}\nsetTimeout(() => {\n    Jartto;\n});\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[s("code",[e._v("onerror")]),e._v("无法捕获语法错误；")]),e._v(" "),s("h4",{attrs:{id:"_3-3-监听-error-事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-监听-error-事件"}},[e._v("#")]),e._v(" 3.3 监听 error 事件")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<img src=\"./xxxxx.png\">\nwindow.addEventListener('error', args => {\n    console.log(\n      'error event:', args\n    );\n    return true;\n  },\n  true // 利用捕获方式\n);\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])]),s("p",[e._v("运行结果如下：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('error event： Event:{\n    bubbles: false\n    cancelBubble: false\n    cancelable: false\n    composed: false\n    currentTarget: null\n    defaultPrevented: false\n    eventPhase: 0\n    isTrusted: true\n    path: (5) [img, body, html, document, Window]\n    returnValue: true\n    srcElement: img\n    target: img\n    timeStamp: 373.70499999815365\n    type: "error"\n    __proto__: Event\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br")])]),s("p",[e._v("由于网络请求异常不会事件冒泡，因此必须在捕获阶段将其捕捉到才行，但是这种方式虽然可以捕捉到网络请求的异常，但是无法判断 HTTP 状态是"),s("code",[e._v("404")]),e._v("还是其他状态，所心还需要配合服务端日志才进行排查分析才可以。")]),e._v(" "),s("p",[e._v("注意：")]),e._v(" "),s("ul",[s("li",[e._v("不同浏览器下返回的"),s("code",[e._v("error")]),e._v("对象可能不同，需要注意兼容处理。")]),e._v(" "),s("li",[e._v("需要注意避免"),s("code",[e._v("addEventListener")]),e._v("重复监听。")])]),e._v(" "),s("p",[e._v("结论：监听"),s("code",[e._v("error")]),e._v("事件，可以捕获同步错误，异步错误，网络错误，不能处理"),s("code",[e._v("Promise")]),e._v("错误")]),e._v(" "),s("h4",{attrs:{id:"_3-4-unhandledrejection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-unhandledrejection"}},[e._v("#")]),e._v(" 3.4 unhandledrejection")]),e._v(" "),s("p",[e._v("在"),s("code",[e._v("promise")]),e._v("中使用"),s("code",[e._v("catch")]),e._v("可以非常方便的捕获到异步"),s("code",[e._v("error")]),e._v("，如果没有写"),s("code",[e._v("catch")]),e._v("的"),s("code",[e._v("Promise")]),e._v("中抛出的错误无法被"),s("code",[e._v("onerror")]),e._v("或"),s("code",[e._v("try-catch")]),e._v("捕获到，为了防止有漏掉的"),s("code",[e._v("Promise")]),e._v("异步，建议在全局增加一个对"),s("code",[e._v("unhandledrejection")]),e._v("的监听，用来全局监听"),s("code",[e._v("Uncaught Promise Error")]),e._v("。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("window.addEventListener(\"unhandledrejection\", function(e){\n  e.preventDefault()\n  console.log('捕获到异常：', e);\n  return true;\n});\nPromise.reject('promise error');\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("输出结果：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('PromiseRejectionEvent={\n    bubbles: false\n    cancelBubble: false\n    cancelable: true\n    composed: false\n    currentTarget: Window {parent: Window, opener: null, top: Window, length: 0, frames: Window, …}\n    defaultPrevented: true\n    eventPhase: 0\n    isTrusted: true\n    path: [Window]\n    promise: Promise {<rejected>: "promise error"}\n    reason: "promise error"\n    returnValue: false\n    srcElement: Window {parent: Window, opener: null, top: Window, length: 0, frames: Window, …}\n    target: Window {parent: Window, opener: null, top: Window, length: 0, frames: Window, …}\n    timeStamp: 23.06500000122469\n    type: "unhandledrejection"\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br")])]),s("h4",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("异常类型")]),e._v(" "),s("th",[e._v("同步方法")]),e._v(" "),s("th",[e._v("异步方法")]),e._v(" "),s("th",[e._v("资源加载")]),e._v(" "),s("th",[e._v("Promise")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("try/catch")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("不可以")])]),e._v(" "),s("tr",[s("td",[e._v("onerror")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("不可以")])]),e._v(" "),s("tr",[s("td",[e._v("error 事件监听")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("可以")]),e._v(" "),s("td",[e._v("可以")])]),e._v(" "),s("tr",[s("td",[e._v("unhandledrejection")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("不可以")]),e._v(" "),s("td",[e._v("可以")])])])]),e._v(" "),s("h3",{attrs:{id:"四、错误监控常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、错误监控常见问题"}},[e._v("#")]),e._v(" 四、错误监控常见问题")]),e._v(" "),s("ul",[s("li",[e._v("跨域问题")]),e._v(" "),s("li",[e._v("代码压缩后，如何处理定位到代码问题")]),e._v(" "),s("li",[e._v("Promise Catch")]),e._v(" "),s("li",[e._v("VUE errorHandler")]),e._v(" "),s("li",[e._v("React 异常捕获")]),e._v(" "),s("li",[e._v("iframe 异常")]),e._v(" "),s("li",[e._v("崩溃和卡顿")])]),e._v(" "),s("h3",{attrs:{id:"五、错误上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、错误上传"}},[e._v("#")]),e._v(" 五、错误上传")]),e._v(" "),s("h4",{attrs:{id:"_5-1-动态创建-img-标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-动态创建-img-标签"}},[e._v("#")]),e._v(" 5.1 动态创建 img 标签")]),e._v(" "),s("p",[e._v("其实上报就是要将捕获的异常信息发送到后端。最常用的方式首推动态创建标签方式。因为这种方式无需加载任何通讯库，而且页面是无需刷新的。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("new Image().src = 'http://localhost:7001/monitor/error'+ '?info=xxxxxx'\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"_5-2-ajax-上报"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-ajax-上报"}},[e._v("#")]),e._v(" 5.2 Ajax 上报")]),e._v(" "),s("p",[e._v("实际上我们也可以用 ajax 的方式上报错误，这和我们再业务程序中并没有什么区别。在这里就不赘述。")]),e._v(" "),s("h3",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[e._v("#")]),e._v(" 参考资料")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://juejin.im/post/5e5e423ae51d4527041172b6",target:"_blank",rel:"noopener noreferrer"}},[e._v("使用 vue+node 搭建前端异常监控系统"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/JEDt9BL2eWpVTrtbfEPiAA",target:"_blank",rel:"noopener noreferrer"}},[e._v("接入 sentry-让你的错误别再裸奔"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/51800345",target:"_blank",rel:"noopener noreferrer"}},[e._v("如何优雅处理前端异常？"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/31979395",target:"_blank",rel:"noopener noreferrer"}},[e._v("前端代码异常监控实战"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://cdc.tencent.com/2018/09/13/frontend-exception-monitor-research/",target:"_blank",rel:"noopener noreferrer"}},[e._v("前端异常监控解决方案研究"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"http://unclechen.github.io/2018/06/24/%E6%8F%AD%E5%BC%80JS%E6%97%A0%E5%9F%8B%E7%82%B9%E6%8A%80%E6%9C%AF%E7%9A%84%E7%A5%9E%E7%A7%98%E9%9D%A2%E7%BA%B1/",target:"_blank",rel:"noopener noreferrer"}},[e._v("揭开 JS 无埋点技术的神秘面纱"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/LGbMXauSuuGWcvqazjXWjQ",target:"_blank",rel:"noopener noreferrer"}},[e._v("【第 790 期】构建可靠的前端异常监控服务-采集篇"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.im/post/5e3146cce51d453176604809",target:"_blank",rel:"noopener noreferrer"}},[e._v("撸一个前端监控系统（React + Node + Mysql + Webpack plugin + Docker）—— （上）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.im/post/5e6b16315188254963277621",target:"_blank",rel:"noopener noreferrer"}},[e._v("转转商业前端错误监控系统(Sentry)策略升级"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/40273861",target:"_blank",rel:"noopener noreferrer"}},[e._v("如何监控网页崩溃？"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/_AaZXxvMMFjHAynXylsjrw",target:"_blank",rel:"noopener noreferrer"}},[e._v("【第 833 期】如何设计一个前端监控系统"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"联系作者"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#联系作者"}},[e._v("#")]),e._v(" 联系作者")]),e._v(" "),s("div",{attrs:{align:"center"}},[s("p",[e._v("\n        平凡世界，贵在坚持。\n    ")]),e._v(" "),s("img",{attrs:{src:e.$withBase("/about/contact.png")}})]),e._v("\n```\n")])}),[],!1,null,null,null);n.default=a.exports}}]);