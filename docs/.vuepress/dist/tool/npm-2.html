<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>npm 相关参数 | 小武子知识库</title>
    <meta name="description" content="用心，谈技术。大前端">
    <link rel="icon" href="/hero.jpg">
    
    <link rel="preload" href="/assets/css/0.styles.56546b06.css" as="style"><link rel="preload" href="/assets/js/app.03e859c0.js" as="script"><link rel="preload" href="/assets/js/2.67134772.js" as="script"><link rel="preload" href="/assets/js/205.a35ec0ca.js" as="script"><link rel="preload" href="/assets/js/3.65dbdf4c.js" as="script"><link rel="prefetch" href="/assets/js/10.5f6ff46d.js"><link rel="prefetch" href="/assets/js/100.b3f2beb7.js"><link rel="prefetch" href="/assets/js/101.34bf9424.js"><link rel="prefetch" href="/assets/js/102.e5266f6a.js"><link rel="prefetch" href="/assets/js/103.701fda18.js"><link rel="prefetch" href="/assets/js/104.4827e59a.js"><link rel="prefetch" href="/assets/js/105.cc3ebda1.js"><link rel="prefetch" href="/assets/js/106.db30c3b9.js"><link rel="prefetch" href="/assets/js/107.afcd3d5a.js"><link rel="prefetch" href="/assets/js/108.d9601149.js"><link rel="prefetch" href="/assets/js/109.50439987.js"><link rel="prefetch" href="/assets/js/11.f679bcd2.js"><link rel="prefetch" href="/assets/js/110.2fb87414.js"><link rel="prefetch" href="/assets/js/111.5c62f694.js"><link rel="prefetch" href="/assets/js/112.cc37d11f.js"><link rel="prefetch" href="/assets/js/113.fc864e62.js"><link rel="prefetch" href="/assets/js/114.d387bbfa.js"><link rel="prefetch" href="/assets/js/115.71f07353.js"><link rel="prefetch" href="/assets/js/116.7e32b13e.js"><link rel="prefetch" href="/assets/js/117.bc707f9e.js"><link rel="prefetch" href="/assets/js/118.2b7109a5.js"><link rel="prefetch" href="/assets/js/119.70c9cee2.js"><link rel="prefetch" href="/assets/js/12.094cea6a.js"><link rel="prefetch" href="/assets/js/120.fff3e634.js"><link rel="prefetch" href="/assets/js/121.422189db.js"><link rel="prefetch" href="/assets/js/122.8f541e26.js"><link rel="prefetch" href="/assets/js/123.0dd3d320.js"><link rel="prefetch" href="/assets/js/124.aefdeab8.js"><link rel="prefetch" href="/assets/js/125.1b7ea06b.js"><link rel="prefetch" href="/assets/js/126.1b92150a.js"><link rel="prefetch" href="/assets/js/127.7cac8625.js"><link rel="prefetch" href="/assets/js/128.560032d0.js"><link rel="prefetch" href="/assets/js/129.3c134a2b.js"><link rel="prefetch" href="/assets/js/13.1fec2da6.js"><link rel="prefetch" href="/assets/js/130.149f87e1.js"><link rel="prefetch" href="/assets/js/131.581e4ea1.js"><link rel="prefetch" href="/assets/js/132.7a5b2d29.js"><link rel="prefetch" href="/assets/js/133.0adf0902.js"><link rel="prefetch" href="/assets/js/134.448cb2a6.js"><link rel="prefetch" href="/assets/js/135.df4ff123.js"><link rel="prefetch" href="/assets/js/136.481db65e.js"><link rel="prefetch" href="/assets/js/137.d97a0f6b.js"><link rel="prefetch" href="/assets/js/138.baa7fe25.js"><link rel="prefetch" href="/assets/js/139.5a402f39.js"><link rel="prefetch" href="/assets/js/14.9a8bcc5b.js"><link rel="prefetch" href="/assets/js/140.9d100dcf.js"><link rel="prefetch" href="/assets/js/141.706aeb7e.js"><link rel="prefetch" href="/assets/js/142.55ca3738.js"><link rel="prefetch" href="/assets/js/143.88f3a516.js"><link rel="prefetch" href="/assets/js/144.062981a9.js"><link rel="prefetch" href="/assets/js/145.3ef68098.js"><link rel="prefetch" href="/assets/js/146.3e1a9c29.js"><link rel="prefetch" href="/assets/js/147.b2bac89a.js"><link rel="prefetch" href="/assets/js/148.12cb2373.js"><link rel="prefetch" href="/assets/js/149.bb6abe0b.js"><link rel="prefetch" href="/assets/js/15.499164ba.js"><link rel="prefetch" href="/assets/js/150.aebe5597.js"><link rel="prefetch" href="/assets/js/151.d3517537.js"><link rel="prefetch" href="/assets/js/152.37c9bdbb.js"><link rel="prefetch" href="/assets/js/153.8aa3744d.js"><link rel="prefetch" href="/assets/js/154.19642ea7.js"><link rel="prefetch" href="/assets/js/155.49fef4a8.js"><link rel="prefetch" href="/assets/js/156.f15644a9.js"><link rel="prefetch" href="/assets/js/157.86eae2cf.js"><link rel="prefetch" href="/assets/js/158.b87364c3.js"><link rel="prefetch" href="/assets/js/159.c20c16df.js"><link rel="prefetch" href="/assets/js/16.d8f6cbd7.js"><link rel="prefetch" href="/assets/js/160.2a83ba4f.js"><link rel="prefetch" href="/assets/js/161.014c5cff.js"><link rel="prefetch" href="/assets/js/162.ebe6c9ba.js"><link rel="prefetch" href="/assets/js/163.82c8f924.js"><link rel="prefetch" href="/assets/js/164.6fb08cda.js"><link rel="prefetch" href="/assets/js/165.1f80eb4c.js"><link rel="prefetch" href="/assets/js/166.707db743.js"><link rel="prefetch" href="/assets/js/167.fe7cdcb7.js"><link rel="prefetch" href="/assets/js/168.2e0a099e.js"><link rel="prefetch" href="/assets/js/169.1aa764ea.js"><link rel="prefetch" href="/assets/js/17.729ab9c5.js"><link rel="prefetch" href="/assets/js/170.bbdcae00.js"><link rel="prefetch" href="/assets/js/171.4443c8ab.js"><link rel="prefetch" href="/assets/js/172.f9be16aa.js"><link rel="prefetch" href="/assets/js/173.b5beff1b.js"><link rel="prefetch" href="/assets/js/174.57c29bf5.js"><link rel="prefetch" href="/assets/js/175.554742c5.js"><link rel="prefetch" href="/assets/js/176.a058cb9b.js"><link rel="prefetch" href="/assets/js/177.f0ccd9cd.js"><link rel="prefetch" href="/assets/js/178.f5aad6cd.js"><link rel="prefetch" href="/assets/js/179.78afa1ab.js"><link rel="prefetch" href="/assets/js/18.8757ca44.js"><link rel="prefetch" href="/assets/js/180.348ed32e.js"><link rel="prefetch" href="/assets/js/181.ecba8143.js"><link rel="prefetch" href="/assets/js/182.b8c1b09c.js"><link rel="prefetch" href="/assets/js/183.c4b7db8f.js"><link rel="prefetch" href="/assets/js/184.6a4dd781.js"><link rel="prefetch" href="/assets/js/185.f0036325.js"><link rel="prefetch" href="/assets/js/186.31e1aee9.js"><link rel="prefetch" href="/assets/js/187.e5f07621.js"><link rel="prefetch" href="/assets/js/188.c3196745.js"><link rel="prefetch" href="/assets/js/189.005110ef.js"><link rel="prefetch" href="/assets/js/19.7c373aeb.js"><link rel="prefetch" href="/assets/js/190.b5722345.js"><link rel="prefetch" href="/assets/js/191.1a2f7219.js"><link rel="prefetch" href="/assets/js/192.5cd7acf1.js"><link rel="prefetch" href="/assets/js/193.1d9a4d63.js"><link rel="prefetch" href="/assets/js/194.c838209d.js"><link rel="prefetch" href="/assets/js/195.edbf1477.js"><link rel="prefetch" href="/assets/js/196.abd3e313.js"><link rel="prefetch" href="/assets/js/197.d0885970.js"><link rel="prefetch" href="/assets/js/198.a045b639.js"><link rel="prefetch" href="/assets/js/199.afeeaaf5.js"><link rel="prefetch" href="/assets/js/20.c416e477.js"><link rel="prefetch" href="/assets/js/200.1915a7ee.js"><link rel="prefetch" href="/assets/js/201.a8f7f19e.js"><link rel="prefetch" href="/assets/js/202.24ad78b8.js"><link rel="prefetch" href="/assets/js/203.826d3361.js"><link rel="prefetch" href="/assets/js/204.5afd5bd4.js"><link rel="prefetch" href="/assets/js/206.22d9f4ab.js"><link rel="prefetch" href="/assets/js/207.1815b473.js"><link rel="prefetch" href="/assets/js/208.77c227ff.js"><link rel="prefetch" href="/assets/js/209.92e4147e.js"><link rel="prefetch" href="/assets/js/21.e6a85d01.js"><link rel="prefetch" href="/assets/js/210.e4a78f06.js"><link rel="prefetch" href="/assets/js/211.74aaf141.js"><link rel="prefetch" href="/assets/js/212.843f7f0b.js"><link rel="prefetch" href="/assets/js/213.1dfa1453.js"><link rel="prefetch" href="/assets/js/214.058c906d.js"><link rel="prefetch" href="/assets/js/215.827341f0.js"><link rel="prefetch" href="/assets/js/216.78e1f45e.js"><link rel="prefetch" href="/assets/js/22.3604f117.js"><link rel="prefetch" href="/assets/js/23.6b72208c.js"><link rel="prefetch" href="/assets/js/24.5d2573ca.js"><link rel="prefetch" href="/assets/js/25.2e1e1a1a.js"><link rel="prefetch" href="/assets/js/26.2f93ad81.js"><link rel="prefetch" href="/assets/js/27.4b0bc419.js"><link rel="prefetch" href="/assets/js/28.4ed49140.js"><link rel="prefetch" href="/assets/js/29.7b5b46de.js"><link rel="prefetch" href="/assets/js/30.dbd5417d.js"><link rel="prefetch" href="/assets/js/31.a955e900.js"><link rel="prefetch" href="/assets/js/32.2303df35.js"><link rel="prefetch" href="/assets/js/33.633d68c2.js"><link rel="prefetch" href="/assets/js/34.4ae45bf6.js"><link rel="prefetch" href="/assets/js/35.11e47271.js"><link rel="prefetch" href="/assets/js/36.6c80e700.js"><link rel="prefetch" href="/assets/js/37.a707c408.js"><link rel="prefetch" href="/assets/js/38.a108fa42.js"><link rel="prefetch" href="/assets/js/39.28df4704.js"><link rel="prefetch" href="/assets/js/4.62bccd38.js"><link rel="prefetch" href="/assets/js/40.8261b571.js"><link rel="prefetch" href="/assets/js/41.1d98f503.js"><link rel="prefetch" href="/assets/js/42.9f4703a8.js"><link rel="prefetch" href="/assets/js/43.3c1a2da4.js"><link rel="prefetch" href="/assets/js/44.b6d6e3d4.js"><link rel="prefetch" href="/assets/js/45.0f904605.js"><link rel="prefetch" href="/assets/js/46.857f9e3a.js"><link rel="prefetch" href="/assets/js/47.42767489.js"><link rel="prefetch" href="/assets/js/48.78981c7b.js"><link rel="prefetch" href="/assets/js/49.6c6d462b.js"><link rel="prefetch" href="/assets/js/5.444b0f34.js"><link rel="prefetch" href="/assets/js/50.7862a25c.js"><link rel="prefetch" href="/assets/js/51.6ae0058c.js"><link rel="prefetch" href="/assets/js/52.d4704614.js"><link rel="prefetch" href="/assets/js/53.e936ff41.js"><link rel="prefetch" href="/assets/js/54.935e07b8.js"><link rel="prefetch" href="/assets/js/55.b1a73ddd.js"><link rel="prefetch" href="/assets/js/56.c86c6731.js"><link rel="prefetch" href="/assets/js/57.494b78c5.js"><link rel="prefetch" href="/assets/js/58.da509d81.js"><link rel="prefetch" href="/assets/js/59.aea994a1.js"><link rel="prefetch" href="/assets/js/6.951a2a7b.js"><link rel="prefetch" href="/assets/js/60.e961bc19.js"><link rel="prefetch" href="/assets/js/61.2428ee2d.js"><link rel="prefetch" href="/assets/js/62.e38cccaf.js"><link rel="prefetch" href="/assets/js/63.cb439c60.js"><link rel="prefetch" href="/assets/js/64.4fdf0807.js"><link rel="prefetch" href="/assets/js/65.866f4307.js"><link rel="prefetch" href="/assets/js/66.43d6d0a3.js"><link rel="prefetch" href="/assets/js/67.61b6e0b8.js"><link rel="prefetch" href="/assets/js/68.0633f57d.js"><link rel="prefetch" href="/assets/js/69.f872455a.js"><link rel="prefetch" href="/assets/js/7.15cd62f8.js"><link rel="prefetch" href="/assets/js/70.e6f4e18f.js"><link rel="prefetch" href="/assets/js/71.b9bd0cba.js"><link rel="prefetch" href="/assets/js/72.9a7d9989.js"><link rel="prefetch" href="/assets/js/73.ce5c1749.js"><link rel="prefetch" href="/assets/js/74.271d0a2a.js"><link rel="prefetch" href="/assets/js/75.2cccca4f.js"><link rel="prefetch" href="/assets/js/76.4916092c.js"><link rel="prefetch" href="/assets/js/77.e733fee5.js"><link rel="prefetch" href="/assets/js/78.6a8fe940.js"><link rel="prefetch" href="/assets/js/79.509d1c90.js"><link rel="prefetch" href="/assets/js/8.7b0a045e.js"><link rel="prefetch" href="/assets/js/80.404352ce.js"><link rel="prefetch" href="/assets/js/81.1a581f50.js"><link rel="prefetch" href="/assets/js/82.413dccb5.js"><link rel="prefetch" href="/assets/js/83.5f53b187.js"><link rel="prefetch" href="/assets/js/84.26a2b300.js"><link rel="prefetch" href="/assets/js/85.88e0166a.js"><link rel="prefetch" href="/assets/js/86.ca852ce9.js"><link rel="prefetch" href="/assets/js/87.95b24b64.js"><link rel="prefetch" href="/assets/js/88.805ef3bd.js"><link rel="prefetch" href="/assets/js/89.ced85f21.js"><link rel="prefetch" href="/assets/js/9.aadeaa9b.js"><link rel="prefetch" href="/assets/js/90.0470a9e2.js"><link rel="prefetch" href="/assets/js/91.c0d1a019.js"><link rel="prefetch" href="/assets/js/92.2558e572.js"><link rel="prefetch" href="/assets/js/93.f77e5612.js"><link rel="prefetch" href="/assets/js/94.b163ecda.js"><link rel="prefetch" href="/assets/js/95.0e7b0730.js"><link rel="prefetch" href="/assets/js/96.0b71cb11.js"><link rel="prefetch" href="/assets/js/97.046f795c.js"><link rel="prefetch" href="/assets/js/98.1db09e01.js"><link rel="prefetch" href="/assets/js/99.1352c2fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56546b06.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小武子知识库</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/js/" class="nav-link">javascript</a></div><div class="nav-item"><a href="/css/" class="nav-link">css</a></div><div class="nav-item"><a href="/html5/" class="nav-link">HTML5</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">工具</a></div><div class="nav-item"><a href="/project/" class="nav-link">软件工程</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机基础</a></div><div class="nav-item"><a href="/materials/" class="nav-link">资料收集</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于作者</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/js/" class="nav-link">javascript</a></div><div class="nav-item"><a href="/css/" class="nav-link">css</a></div><div class="nav-item"><a href="/html5/" class="nav-link">HTML5</a></div><div class="nav-item"><a href="/tool/" class="nav-link router-link-active">工具</a></div><div class="nav-item"><a href="/project/" class="nav-link">软件工程</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机基础</a></div><div class="nav-item"><a href="/materials/" class="nav-link">资料收集</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于作者</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>git版本工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/git.html" class="sidebar-link">git 常用命令与 gitflow 工作流</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>WEB集成化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/ci-cd.html" class="sidebar-link">CI与CD介绍</a></li><li><a href="/tool/npm-1.html" class="sidebar-link">私有npm仓库搭建</a></li><li><a href="/tool/npm-2.html" class="active sidebar-link">npm 相关参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tool/npm-2.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/tool/npm-2.html#内容" class="sidebar-link">内容</a></li><li class="sidebar-sub-header"><a href="/tool/npm-2.html#联系作者" class="sidebar-link">联系作者</a></li></ul></li><li><a href="/tool/webhook.html" class="sidebar-link">webhook</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack打包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/webpack-basic.html" class="sidebar-link">webpack配置</a></li><li><a href="/tool/webpack-babel.html" class="sidebar-link">babel学习</a></li><li><a href="/tool/webpack-plugin.html" class="sidebar-link">webpack插件</a></li><li><a href="/tool/webpack-loader.html" class="sidebar-link">常用loader学习</a></li><li><a href="/tool/webpack-coder.html" class="sidebar-link">webpack源码分析</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>gulp打包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/gulp-basic.html" class="sidebar-link">gulp 入门学习</a></li><li><a href="/tool/gulp-plugin.html" class="sidebar-link">gulp插件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>rollup打包</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/rollup-basic.html" class="sidebar-link">rollup常用配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>自定义脚手架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/cli.html" class="sidebar-link">自定义脚手架</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>docker配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/docker.html" class="sidebar-link">docker 入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ngnix配置</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tool/nginx.html" class="sidebar-link">nginx 常用配置</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="npm-相关参数"><a href="#npm-相关参数" aria-hidden="true" class="header-anchor">#</a> npm 相关参数</h1> <h2 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h2> <p><code>npm</code>在前端开发流程中提供了非常完善的自动化工具链，已成为每个前端开发者必备的工具，但是同样由于其强大性导致很多前端开发者只会简单的使用它。本文将总结在日常开发中所需要的<code>npm</code>知识点，以便开发者们更好的将<code>npm</code>运用在实际开发中。</p> <h2 id="内容"><a href="#内容" aria-hidden="true" class="header-anchor">#</a> 内容</h2> <ul><li>npm 处理 node_modules 目录结构</li> <li>npm 中的依赖包</li> <li>npm scripts 脚本</li> <li>npm 配置</li> <li>npm 工程管理</li> <li>npm 的几个实用技巧</li></ul> <h3 id="一、npm-处理-node-modules-目录结构"><a href="#一、npm-处理-node-modules-目录结构" aria-hidden="true" class="header-anchor">#</a> 一、npm 处理 node_modules 目录结构</h3> <p>一个项目开发、上线所依赖的插件包都存放在<code>node_modules</code>中。虽然在实际开发中无需关注这个目录里面的文件结构细节，但了解<code>node_modules</code>中的内容可以帮助我们更好的理解<code>npm</code>组织这些文件的机制。</p> <p>假设项目<code>App</code>中有如下三个依赖：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;dependencies&quot;: {
    A: &quot;1.0.0&quot;,
    B: &quot;1.0.0&quot;,
    C: &quot;1.0.0&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>A</code>、<code>B</code>、<code>C</code>三个模块又有如下依赖：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>A@1.0.0 -&gt; D@1.0.0

B@1.0.0 -&gt; D@2.0.0

C@1.0.0 -&gt; D@1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_1-1-npm-2-x-嵌套结构"><a href="#_1-1-npm-2-x-嵌套结构" aria-hidden="true" class="header-anchor">#</a> 1.1 npm 2.x - 嵌套结构</h4> <p><code>npm 2.x</code>安装依赖方式比较简单直接，以递归的方式，按照包依赖的树形结构下载填充本地目录结构，也就是说每个包都会将该包依赖安装到当前包所在的<code>node_modules</code>目录中。</p> <p>执行<code>npm install</code>后，项目<code>App</code>的<code>node_modules</code>会变成如下目录结构：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── node_modules
│   ├── A@1.0.0
│   │   └── node_modules
│   │   │   └── D@1.0.0
│   ├── B@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
│   └── C@1.0.0
│   │   └── node_modules
│   │   │   └── D@1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>很显然这样的依赖组织结构，有如下优点：</p> <ul><li>层级结构明显</li> <li>简单的实现多版本兼容</li> <li>保证了对依赖包无论是安装还是删除都会有统一的行为和结构</li></ul> <p>但是缺点也一样明显：</p> <ul><li>可能造成相同模块大量冗余问题</li> <li>可能造成目录结构嵌套比较深的问题</li></ul> <h4 id="_1-2-npm-3-x-扁平结构"><a href="#_1-2-npm-3-x-扁平结构" aria-hidden="true" class="header-anchor">#</a> 1.2 npm 3.x - 扁平结构</h4> <p><code>npm 3.x</code>则采用了扁平化的结构来安装组织<code>node_modules</code>。也就是在执行<code>npm install</code>的时候，按照<code>package.json</code>里依赖的顺序依次解析，<strong>遇到新的包就把它安装在第一级目录，后续安装如果遇到一级目录已经存在的包，会先按照约定版本判断版本，如果符合版本约定则忽略，否则会按照<code>npm 2.x</code>的方式依次挂在依赖包目录下。</strong></p> <p>还以项目<code>App</code>为例，在<code>npm 3.x</code>环境下，执行<code>npm install</code>后，<code>node_modules</code>会变成如下目录结构：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── node_modules
│   ├── A@1.0.0
│   ├── D@1.0.0
│   ├── B@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
│   └── C@1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>模块的安装次序决定了<code>node_modules</code>中的目录结构，<code>npm</code>会优先将模块安装在根目录下的<code>node_modules</code>中。</p></blockquote> <p>再在项目中安装模块<code>E@1.0.0</code>（依赖于模块<code>D@2.0.0</code>），目录结构变为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── node_modules
│   ├── A@1.0.0
│   ├── D@1.0.0
│   ├── B@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
│   └── C@1.0.0
│   ├── E@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>B</code>、<code>E</code>模块下都包含了依赖的模块<code>D@2.0.0</code>，存在代码冗余的情况。</p> <p>再在项目中安装模块<code>F@1.0.0</code>（依赖于模块<code>D@1.0.0</code>）。由于<code>D@1.0.0</code>已经存在于项目根目录下的<code>node_modules</code>下，所以在安装F模块的时候，无需再在其依赖包中安装<code>D@1.0.0</code>模块，目录结构变为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── node_modules
│   ├── A@1.0.0
│   ├── D@1.0.0
│   ├── B@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
│   └── C@1.0.0
│   ├── E@1.0.0
│   │   └── node_modules
│   │   │   └── D@2.0.0
│   └── F@1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>从以上结构可以看出，<code>npm 3.x</code>并没有完美的解决<code>npm 2.x</code>中的问题，甚至还会退化到<code>npm 2.x</code>的行为。</p> <p>为了解决目录中存在很多副本的情况，（在<code>A</code>、<code>C</code>模块的依赖模块<code>D</code>升级到<code>2.0.0</code>前提下）可以通过<code>npm dedupe</code>指令把所有二级的依赖模块D@2.0.0重定向到一级目录下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── node_modules
│   ├── A@1.0.0
│   ├── D@2.0.0
│   ├── B@1.0.0
│   └── C@1.0.0
│   ├── E@1.0.0
│   └── F@1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p><code>node_modules</code>路径查找机制：模块再找对应的依赖包时，nodejs会尝试从当前模块所在目录开始，尝试在它的<code>node_modules</code>文件夹里加载相应模块，如果没有找到，那么就再向上一级目录移动，直到全局安装路径中的<code>node_modules</code>为止。</p></blockquote> <h4 id="_1-3-npm-5-x-package-lock-json"><a href="#_1-3-npm-5-x-package-lock-json" aria-hidden="true" class="header-anchor">#</a> 1.3 npm 5.x - package-lock.json</h4> <p>从<code>npm 5.x</code>开始，安装组织<code>node_modules</code>和<code>npm 3.x</code>一样采用了扁平的方式，最大的变化是增加了<a href="https://docs.npmjs.com/files/package-lock.json" target="_blank" rel="noopener noreferrer">package-lock.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>文件。</p> <p><code>npm</code>为了让开发者在安全的前提下使用最新的依赖包，在<code>package.json</code>中通常做了锁定大版本的操作，这样在每次<code>npm install</code>的时候都会拉取依赖包大版本下的最新的版本。这种机制最大的一个缺点就是当有依赖包有小版本更新时，可能会出现协同开发者的依赖包不一致的问题。</p> <p><code>package-lock.json</code>文件精确描述了<code>node_modules</code>目录下所有的包的树状依赖结构，每个包的版本号都是完全精确的。以<code>sass-loader</code>在<code>package-lock.json</code>中为例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;dependencies&quot;: {
  &quot;sass-loader&quot;: {
    &quot;version&quot;: &quot;7.1.0&quot;,
    &quot;resolved&quot;: &quot;http://registry.npm.taobao.org/sass-loader/download/sass-loader-7.1.0.tgz&quot;,
    &quot;integrity&quot;: &quot;sha1-Fv1ROMuLQkv4p1lSihly1yqtBp0=&quot;,
    &quot;dev&quot;: true,
    &quot;requires&quot;: {
      &quot;clone-deep&quot;: &quot;^2.0.1&quot;,
      &quot;loader-utils&quot;: &quot;^1.0.1&quot;,
      &quot;lodash.tail&quot;: &quot;^4.1.1&quot;,
      &quot;neo-async&quot;: &quot;^2.5.0&quot;,
      &quot;pify&quot;: &quot;^3.0.0&quot;,
      &quot;semver&quot;: &quot;^5.5.0&quot;
    },
    &quot;dependencies&quot;: {
      &quot;pify&quot;: {
        &quot;version&quot;: &quot;3.0.0&quot;,
        &quot;resolved&quot;: &quot;http://registry.npm.taobao.org/pify/download/pify-3.0.0.tgz&quot;,
        &quot;integrity&quot;: &quot;sha1-5aSs0sEB/fPZpNB/DbxNtJ3SgXY=&quot;,
        &quot;dev&quot;: true
      }
    }
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><code>package-lock.json</code>的详细描述主要由<code>version</code>、<code>resolved</code>、<code>integrity</code>、<code>dev</code>、<code>requires</code>、<code>dependencies</code>这几个字段构成：</p> <ul><li><code>version</code>：包唯一的版本号</li> <li><code>resolved</code>：安装源</li> <li><code>integrity</code>：表明包完整性的hash值（验证包是否已失效）</li> <li><code>dev</code>：如果为true，则此依赖关系仅是顶级模块的开发依赖关系或者是一个的传递依赖关系</li> <li><code>requires</code>：依赖包所需要的所有依赖项，对应依赖包<code>package.json</code>里<code>dependencies</code>中的依赖项</li> <li><code>dependencies</code>：依赖包<code>node_modules</code>中依赖的包，与顶层的<code>dependencies</code>一样的结构</li></ul> <p>在上面的<code>package-lock.json</code>文件中可以发现，在<code>requires</code>和<code>dependencies</code>中都存在<code>pify</code>依赖项。那我们顺便去<code>node_modules</code>里面探下究竟：</p> <ol><li>打开根目录的<code>node_modules</code>会发现安装了<code>sass-loader</code>所需要的所有依赖包，这些依赖包中除了<code>pify</code>以外，所有依赖包的大版本号都与<code>sass-loader</code>所需要的一致。</li> <li>到根目录的<code>node_modules</code>找到<code>pify</code>依赖包，发现版本为<code>4.0.1</code>。</li> <li>找到<code>sass-loader</code>项目依赖包，打开其<code>node_modules</code>发现其中也存在个<code>pify</code>依赖包，但版本为<code>3.0.0</code>。这个版本的<code>sass-loader</code>真正依赖的是这个版本的<code>pify</code>。</li></ol> <p>通过以上几个步骤，也验证了之前阐述过的<code>npm 5.x</code>是扁平化处理依赖的方式。</p> <p>在开发一个应用时，建议把<code>package-lock.json</code>文件提交到代码版本仓库，从而让你的团队成员、运维部署人员或<code>CI</code>系统可以在执行<code>npm install</code>时安装的依赖版本都是一致的。</p> <p>但是在开发一个库时，则不应把<code>package-lock.json</code>文件发布到仓库中。实际上，<code>npm</code>也默认不会把<code>package-lock.json</code>文件发布出去。之所以这么做，是因为库项目一般是被其他项目依赖的，在不写死的情况下，就可以复用主项目已经加载过的包，而一旦库依赖的是精确的版本号那么可能会造成包的冗余。</p> <h3 id="二、npm-中的依赖包"><a href="#二、npm-中的依赖包" aria-hidden="true" class="header-anchor">#</a> 二、npm 中的依赖包</h3> <h4 id="_2-1-依赖包分类"><a href="#_2-1-依赖包分类" aria-hidden="true" class="header-anchor">#</a> 2.1 依赖包分类</h4> <p>在<code>node</code>中其实总共5种依赖：</p> <ul><li><strong>dependencies - 业务依赖</strong></li> <li><strong>devDependencies - 开发依赖</strong></li> <li><strong>peerDependencies - 同伴依赖</strong></li> <li><strong>bundledDependencies / bundleDependencies - 打包依赖</strong></li> <li><strong>optionalDependencies - 可选依赖</strong></li></ul> <p>作为<code>npm</code>的使用者，我们常用的依赖是<code>dependencies</code>和<code>devDependencies</code>，剩下三种依赖则是作为包的发布才会使用到的字段。</p> <p><strong>dependencies</strong></p> <p>这种依赖在项目最终上线或者发布<code>npm</code>包时所需要，即其中的依赖项应该属于线上代码的一部分。比如框架<code>vue</code>，第三方的组件库<code>element-ui</code>等，这些依赖包都是必须装在这个选项里供生产环境使用。</p> <p>通过命令<code>npm install/i packageName -S/--save</code>把包装在此依赖项里。如果没有指定版本，直接写一个包的名字，则安装当前<code>npm</code>仓库中这个包的最新版本。如果要指定版本的，可以把版本号写在包名后面，比如<code>npm i vue@3.0.1 -S</code>。</p> <blockquote><p>从<code>npm 5.x</code>开始，可以不用手动添加<code>-S/--save</code>指令，直接执行<code>npm i packageName</code>把依赖包添加到<code>dependencies</code>中去。</p></blockquote> <p><strong>devDependencies</strong></p> <p>这种依赖只在项目开发时所需要，即其中的依赖项不应该属于线上代码的一部分。比如构建工具<code>webpack</code>、<code>gulp</code>，预处理器<code>babel-loader</code>、<code>scss-loader</code>，测试工具<code>e2e</code>、<code>chai</code>等，这些都是辅助开发的工具包，无须在生产环境使用。</p> <p>通过命令<code>npm install/i -D/--save-dev</code>把包安装成开发依赖。如果想缩减安装包，可以使用命令<code>npm i --production</code>忽略开发依赖，只安装基本依赖，这通常在线上机器（或者<code>QA</code>环境）上使用。</p> <blockquote><p>**千万别以为只有在<code>dependencies</code>中的模块才会被一起打包，而在<code>devDependencies</code>中的不会！模块能否被打包，取决于项目里是否被引入了该模块！**在业务项目中<code>dependencies</code>和<code>devDependencies</code>没有什么本质区别，只是单纯的一个规范作用，在执行<code>npm i</code>时两个依赖下的模块都会被下载；而在发布<code>npm</code>包的时候，包中的<code>dependencies</code>依赖项在安装该包的时候会被一起下载，<code>devDependencies</code>依赖项则不会。</p></blockquote> <p><strong>peerDependencies</strong></p> <p>这种依赖的作用是提示宿主环境去安装插件在<code>peerDependencies</code>中所指定依赖的包，然后插件所依赖的包永远都是宿主环境统一安装的<code>npm</code>包，最终解决插件与所依赖包不一致的问题。</p> <p>这句话听起来可能有点拗口，举个例子来给大家说明下。<code>element-ui@2.6.3</code>只是提供一套基于<code>vue</code>的<code>ui</code>组件库，但它要求宿主环境需要安装指定的<code>vue</code>版本，所以你可以看到<code>element</code>项目中的<code>package.json</code>中具有一项配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;peerDependencies&quot;: {
    &quot;vue&quot;: &quot;^2.5.16&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>它要求宿主环境安装<code>3.0.0 &gt; vue@ &gt;= 2.5.16</code>的版本，也就是<code>element-ui</code>的运行依赖宿主环境提供的该版本范围的<code>vue</code>依赖包。</p> <p>在安装插件的时候，<code>peerDependencies</code>在<code>npm 2.x</code>和<code>npm 3.x</code>中表现不一样：</p> <p>在<code>npm 2.x</code>中，安装包中<code>peerDependencies</code>所指定的依赖会随着<code>npm install packageName</code>一起被强制安装，并且<code>peerDependencies</code>中指定的依赖会安装在宿主环境中，所以不需要在宿主环境的<code>package.json</code>文件中指定对所安装包中<code>peerDependencies</code>内容的依赖。</p> <p>在<code>npm 3.x</code>中，不会再要求<code>peerDependencies</code>所指定的依赖包被强制安装，<code>npm 3.x</code>只会在安装结束后检查本次安装是否正确，如果不正确会给用户打印警告提示，比如提示用户有的包必须安装或者有的包版本不对等。</p> <blockquote><p>大白话：如果你安装我，那么你最好也要按照我的要求安装<code>A</code>、<code>B</code>和<code>C</code>。</p></blockquote> <p><strong>bundledDependencies</strong></p> <p>这种依赖跟<code>npm pack</code>打包命令有关。假设<code>package.json</code>中有如下配置：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  &quot;name&quot;: &quot;font-end&quot;,
  &quot;version&quot;: &quot;1.0.0&quot;,
  &quot;dependencies&quot;: {
    &quot;fe1&quot;: &quot;^0.3.2&quot;,
    ...
  },
  &quot;devDependencies&quot;: {
    ...
    &quot;fe2&quot;: &quot;^1.0.0&quot;
  },
  &quot;bundledDependencies&quot;: [
    &quot;fe1&quot;,
    &quot;fe2&quot;
  ]
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>执行打包命令<code>npm pack</code>，会生成<code>front-end-1.0.0.tgz</code>压缩包，并且该压缩包中包含<code>fe1</code>和<code>fe2</code>两个安装包，这样使用者执行<code>npm install front-end-1.0.0.tgz</code>也会安装这两个依赖。</p> <blockquote><p>在<code>bundledDependencies</code>中指定的依赖包，必须先在<code>dependencies</code>和<code>devDependencies</code>声明过，否则打包会报错。</p></blockquote> <p><strong>optionalDependencies</strong></p> <p>这种依赖中的依赖项即使安装失败了，也不影响整个安装的过程。需要注意的是，如果一个依赖同时出现在<code>dependencies</code>和<code>optionalDependencies</code>中，那么<code>optionalDependencies</code>会获得更高的优先级，可能造成一些预期之外的效果，所以尽量要避免这种情况发生。</p> <blockquote><p>在实际项目中，如果某个包已经失效，我们通常会寻找它的替代者，或者换一个实现方案。不确定的依赖会增加代码判断和测试难度，所以这个依赖项还是尽量不要使用。</p></blockquote> <h4 id="_2-2-依赖包版本号"><a href="#_2-2-依赖包版本号" aria-hidden="true" class="header-anchor">#</a> 2.2 依赖包版本号</h4> <p><code>npm</code>采用了<code>semver</code>规范作为依赖版本管理方案。</p> <p>按照<code>semver</code>的约定，一个<code>npm</code>依赖包的版本格式一般：<strong>主版本号.次版本号.修订号(<code>x.y.z</code>)</strong>，每个号的含义是：</p> <ul><li><p><strong>主版本号</strong>(也叫大版本，<code>major version</code>)</p> <p>大版本的发动很可能是一次颠覆性的发动，也就意味着可能存在与低版本不兼容的<code>API</code>或者用法，（比如<code>vue 2-&gt;3</code>）。</p></li> <li><p><strong>次版本号</strong>(也叫小版本，<code>minor version</code>)</p> <p>小版本的发动应当兼容同一个大版本内的<code>API</code>和用法，因此应该让开发者无感。所以我们通常只说大版本号，很少会精确到小版本号。</p> <blockquote><p>如果大版本是0的话，表示软件处于初始阶段，一切都可能随时被改变，可能每个小版本之间也会存在不兼容性。所以在选择依赖时，尽量避开大版本号是0的包。</p></blockquote></li> <li><p><strong>修订号</strong>(也叫补丁版本，<code>patch</code>)</p> <p>一般用于修改<code>bug</code>或者很细微的变更，也需要保持向前兼容。</p></li></ul> <p>常见的几个版本格式如下：</p> <ul><li><strong>“1.2.3”</strong></li></ul> <p>表示精确版本号。任何其他版本号都不匹配。在一些比较重要的线上项目中，建议使用这种方式锁定版本。</p> <ul><li><strong>“^1.2.3”</strong></li></ul> <p>表示兼容补丁和小版本更新的版本号。官方的定义是“能够兼容除了最左侧的非 0 版本号之外的其他变化”(Allows changes that do not modify the left-most non-zero digit in the [major, minor, patch] tuple)。这句话很拗口，举几个例子大家就明白了：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;^1.2.3&quot; 等价于 &quot;&gt;= 1.2.3 &lt; 2.0.0&quot;。即只要最左侧的 &quot;1&quot; 不变，其他都可以改变。所以 &quot;1.2.4&quot;, &quot;1.3.0&quot; 都可以兼容。

&quot;^0.2.3&quot; 等价于 &quot;&gt;= 0.2.3 &lt; 0.3.0&quot;。因为最左侧的是 &quot;0&quot;，那么只要第二位 &quot;2&quot; 不变，其他的都兼容，比如 &quot;0.2.4&quot; 和 &quot;0.2.99&quot;。

&quot;^0.0.3&quot; 等价于 &quot;&gt;= 0.0.3 &lt; 0.0.4&quot;。大版本号和小版本号都为 &quot;0&quot; ，所以也就等价于精确的 &quot;0.0.3&quot;。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>从这几个例子可以看出，<code>^</code>是一个兼具更新和安全的写法，但是对于大版本号为 1 和 0 的版本还是会有不同的处理机制的。</p> <ul><li><strong>“~1.2.3”</strong></li></ul> <p>表示只兼容补丁更新的版本号。关于<code>~</code>的定义分为两部分：如果列出了小版本号（第二位），则只兼容补丁（第三位）的修改；如果没有列出小版本号，则兼容第二和第三位的修改。我们分两种情况理解一下定义：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;~1.2.3&quot; 列出了小版本号 &quot;2&quot;，因此只兼容第三位的修改，等价于 &quot;&gt;= 1.2.3 &lt; 1.3.0&quot;。

&quot;~1.2&quot; 也列出了小版本号 &quot;2&quot;，因此和上面一样兼容第三位的修改，等价于 &quot;&gt;= 1.2.0 &lt; 1.3.0&quot;。

&quot;~1&quot; 没有列出小版本号，可以兼容第二第三位的修改，因此等价于 &quot;&gt;= 1.0.0 &lt; 2.0.0&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>从这几个例子可以看出，<code>~</code>是一个比<code>^</code>更加谨慎安全的写法，而且<code>~</code>并不对大版本号0或者1区别对待，所以&quot;~0.2.3&quot; 与 &quot;~1.2.3&quot; 是相同的算法。当首位是 0 并且列出了第二位的时候，两者是等价的，例如 &quot;~0.2.3&quot; 和 &quot;^0.2.3&quot;。</p> <ul><li><strong>&quot;1.x&quot; 、&quot;1.X&quot;、1.<em>&quot;、&quot;1&quot;、&quot;</em>&quot;</strong></li></ul> <p>表示使用通配符的版本号，x、X、* 和 （空） 的含义相同，都表示可以匹配任何内容。具体来说：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;*&quot; 、&quot;x&quot; 或者 （空） 表示可以匹配任何版本。

&quot;1.x&quot;, &quot;1.*&quot; 和 &quot;1&quot; 表示匹配主版本号为 &quot;1&quot; 的所有版本，因此等价于 &quot;&gt;= 1.0.0 &lt; 2.0.0&quot;。

&quot;1.2.x&quot;, &quot;1.2.*&quot; 和 &quot;1.2&quot; 表示匹配版本号以 &quot;1.2&quot; 开头的所有版本，因此等价于 &quot;&gt;= 1.2.0 &lt; 1.3.0&quot;。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>&quot;1.2.3-beta.1&quot;</strong></li></ul> <p>带预发布关键词的版本号。先说说几个预发布关键词的定义：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>alpha(α)：预览版，或者叫内部测试版；一般不向外部发布，会有很多bug；一般只有测试人员使用。

beta(β)：测试版，或者叫公开测试版；这个阶段的版本会一直加入新的功能；在alpha版之后推出。

rc(release candidate)：最终测试版本；可能成为最终产品的候选版本，如果未出现问题则可发布成为正式版本。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>以包开发者的角度来考虑这个问题：假设当前线上版本是 &quot;1.2.3&quot;，如果我作了一些改动需要发布版本 &quot;1.2.4&quot;，但我不想直接上线（因为使用 &quot;~1.2.3&quot; 或者 &quot;^1.2.3&quot; 的用户都会直接静默更新），这就需要使用预发布功能。因此我可能会发布 &quot;1.2.4-alpha.1&quot; 或者 &quot;1.2.4-beta.1&quot; 等等。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;&gt;1.2.4-alpha.1&quot;表示接受 &quot;1.2.4-alpha&quot; 版本下所有大于 1 的预发布版本。因此 &quot;1.2.4-alpha.7&quot; 是符合要求的，但 &quot;1.2.4-beta.1&quot; 和 &quot;1.2.5-alpha.2&quot; 都不符合。此外如果是正式版本（不带预发布关键词），只要版本号符合要求即可，不检查预发布版本号，例如 &quot;1.2.5&quot;, &quot;1.3.0&quot; 都是认可的。

&quot;~1.2.4-alpha.1&quot; 表示 &quot;&gt;=1.2.4-alpha.1 &lt; 1.3.0&quot;。这样 &quot;1.2.5&quot;, &quot;1.2.4-alpha.2&quot; 都符合条件，而 &quot;1.2.5-alpha.1&quot;, &quot;1.3.0&quot; 不符合。

&quot;^1.2.4-alpha.1&quot; 表示 &quot;&gt;=1.2.4-alpha.1 &lt; 2.0.0&quot;。这样 &quot;1.2.5&quot;, &quot;1.2.4-alpha.2&quot;, &quot;1.3.0&quot; 都符合条件，而 &quot;1.2.5-alpha.1&quot;, &quot;2.0.0&quot; 不符合。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>版本号还有更多的写法，例如范围（a - b），大于等于号（&gt;=），小于等于号（&lt;=），或（||）等等，因为用的不多，这里不再展开。详细的文档可以参见<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener noreferrer">语义化版本(semver)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。它同时也是一个 npm 包，可以用来比较两个版本号的大小，以及是否符合要求等。</p> <h4 id="_2-3-依赖包版本管理"><a href="#_2-3-依赖包版本管理" aria-hidden="true" class="header-anchor">#</a> 2.3 依赖包版本管理</h4> <p><code>npm 2.x/3.x</code>已成为过去式，在<code>npm 5.x</code>以上环境下（版本最好在<code>5.6</code>以上，因为在<code>5.0 ~ 5.6</code>中间对<code>package-lock.json</code>的处理逻辑更新过几个版本，<code>5.6</code>以上才开始稳定），管理项目中的依赖包版本你应该知道（以<code>^</code>版本为例，其他类型版本参照即可）：</p> <ol><li>在大版本相同的前提下，如果一个模块在<code>package.json</code>中的小版本要大于<code>package-lock.json</code>中的小版本，则在执行<code>npm install</code>时，会将该模块更新到大版本下的最新的版本，并将版本号更新至<code>package-lock.json</code>。如果小于，则被<code>package-lock.json</code>中的版本锁定。</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>// package-lock.json 中原版本
&quot;clipboard&quot;: {
  &quot;version&quot;: &quot;1.5.10&quot;,
},
&quot;vue&quot;: {
  &quot;version&quot;: &quot;2.6.10&quot;,
}
// package.json 中修改版本
&quot;dependencies&quot;: {
  &quot;clipboard&quot;: &quot;^1.5.12&quot;,
  &quot;vue&quot;: &quot;^2.5.6&quot;
  ...
}

// 执行完 npm install 后，package-lock.json 中
&quot;clipboard&quot;: {
  &quot;version&quot;: &quot;1.7.1&quot;, // 更新到大版本下的最新版本
},
&quot;vue&quot;: {
  &quot;version&quot;: &quot;2.6.10&quot;, // 版本没发生改变
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ol start="2"><li>如果一个模块在<code>package.json</code>和<code>package-lock.json</code>中的大版本不相同，则在执行<code>npm install</code>时，都将根据<code>package.json</code>中大版本下的最新版本进行更新，并将版本号更新至<code>package-lock.json</code>。</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>// package-lock.json 中原版
&quot;clipboard&quot;: {
  &quot;version&quot;: &quot;2.0.4&quot;,
}
// package.json 中修改版本
&quot;dependencies&quot;: {
  &quot;clipboard&quot;: &quot;^1.6.1&quot;,
}

// 执行完npm install后，package-lock.json 中
// 
&quot;clipboard&quot;: {
  &quot;version&quot;: &quot;1.7.1&quot;, // 更新到大版本下的最新版本
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="3"><li><p>如果一个模块在<code>package.json</code>中有记录，而在<code>package-lock.json</code>中无记录，执行<code>npm install</code>后，则会在<code>package-lock.json</code>生成该模块的详细记录。同理，一个模块在<code>package.json</code>中无记录，而在<code>package-lock.json</code>中有记录，执行<code>npm install</code>后，则会在<code>package-lock.json</code>删除该模块的详细记录。</p></li> <li><p>如果要更新某个模块大版本下的最新版本（升级小版本号），请执行如下命令：</p></li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install packageName
// 或者
npm update packageName
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="5"><li>如果要更新到指定版本号（升级大版本号），请执行如下命令：</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install packageName@x.x.x
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="6"><li>卸载某个模块，请执行如下命令：</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm uninstall packageName
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过上述的命令来管理依赖包，<code>package.json</code>和<code>package-lock.json</code>中的版本号都将会随之更新。</p> <blockquote><p>我们在升级/卸载依赖包的时候，尽量通过命令来实现，避免手动修改<code>package.json</code>中的版本号，尤其不要手动修改<code>package-lock.json</code>。</p></blockquote> <h3 id="三、npm-scripts-脚本"><a href="#三、npm-scripts-脚本" aria-hidden="true" class="header-anchor">#</a> 三、npm scripts 脚本</h3> <p><code>package.json</code>中的<a href="https://docs.npmjs.com/misc/scripts" target="_blank" rel="noopener noreferrer">scripts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>字段可以用来自定义脚本命令，它的每一个属性，对应一段脚本。以<code>vue-cli3</code>为例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;serve&quot;: &quot;vue-cli-service serve&quot;,
  ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这样就可以通过<code>npm run serve</code>脚本代替<code>vue-cli-service serve</code>脚本来启动项目，而无需每次敲一遍这么冗长的脚本。</p> <ul><li>工作原理</li> <li>用法指南</li></ul> <h4 id="_3-1-工作原理"><a href="#_3-1-工作原理" aria-hidden="true" class="header-anchor">#</a> 3.1 工作原理</h4> <p><strong>package.json 中的 bin 字段</strong></p> <p><code>package.json</code>中的字段<a href="https://docs.npmjs.com/files/package.json.html#bin" target="_blank" rel="noopener noreferrer">bin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>表示的是一个可执行文件到指定文件源的映射。例如在<code>@vue/cli</code>的<code>package.json</code>中：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;bin&quot;: {
  &quot;vue&quot;: &quot;bin/vue.js&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果全局安装<code>@vue/cli</code>的话，<code>@vue/cli</code>**源文件会被安装在全局源文件安装目录（<code>/user/local/lib/node_modules</code>）下，而<code>npm</code>会在全局可执行<code>bin</code>文件安装目录（<code>/usr/local/bin</code>）下创建一个指向<code>/usr/local/lib/node_modules/@vue/cli/bin/vue.js</code>文件的名为vue的软链接，**这样就可以直接在终端输入<code>vue</code>来执行相关命令。如下图所示：</p> <p><img src="npm01.png" alt="images"></p> <p>如果局部安装<code>@vue/cli</code>的话，<code>npm</code>则会在本地项目<code>./node_modules/.bin</code>目录下创建一个指向<code>./node_moudles/@vue/cli/bin/vue.js</code>文件的名为<code>vue</code>的软链接，这个时候需要在终端中输入<code>./node_modules/.bin/vue</code>来执行（也可以使用<code>npx vue</code>命令来执行，<a href="http://www.ruanyifeng.com/blog/2019/02/npx.html" target="_blank" rel="noopener noreferrer">npx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的作用就是为了方便调用项目内部安装的模块）。</p> <blockquote><p>软链接（符号链接）是一类特殊的可执行文件，其包含有一条以绝对路径或相对路径的形式指向其它文件或者目录的引用。在<code>bin</code>目录下执行<code>ll</code>指令可以查看具体的软链接指向。在对链接文件进行读或写操作的时候，系统会自动把该操作转换为对源文件的操作，但删除链接文件时，系统仅仅删除链接文件，而不删除源文件本身。</p></blockquote> <p><strong>PATH 环境变量</strong></p> <p>在<code>terminal</code>中执行命令时，<strong>命令会在<code>PATH</code>环境变量里包含的路径中去寻找相同名字的可执行文件</strong>。局部安装的包只在<code>./node_modules/.bin</code>中注册了它们的可执行文件，不会被包含在<code>PATH</code>环境变量中，这个时候在<code>terminal</code>中输入命令将会报无法找到的错误。</p> <p>那为什么通过<code>npm run</code>可以执行局部安装的命令行包呢？</p> <p>是因为<strong>每当执行<code>npm run</code>时，会自动新建一个<code>Shell</code>，这个<code>Shell</code>会将当前项目的<code>node_modules/.bin</code>的绝对路径加入到环境变量<code>PATH</code>中，执行结束后，再将环境变量<code>PATH</code>恢复原样。</strong></p> <p>我们来验证下这个说法。首先执行<a href="https://blog.csdn.net/elikang/article/details/88661467" target="_blank" rel="noopener noreferrer">env<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>查看当前所有的环境变量，可以看到PATH环境变量为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以看到运行时的<code>PATH</code>环境变量多了两个路径：<code>npm</code>指令路径和项目中<code>node_modules/.bin</code>的绝对路径。</p> <p>所以，通过<code>npm run</code>可以在不添加路径前缀的情况下直接访问当前项目<code>node_modules/.bin</code>目录里面的可执行文件。</p> <blockquote><p><code>PATH</code>环境变量，是告诉系统，当要求系统运行一个程序而没有告诉它程序所在的完整路径时，系统除了在当前目录下面寻找此程序外，还应到哪些目录下去寻找</p></blockquote> <h4 id="_3-2-用法指南"><a href="#_3-2-用法指南" aria-hidden="true" class="header-anchor">#</a> 3.2 用法指南</h4> <p><strong>传入参数</strong></p> <p>关于<code>scripts</code>中的参数，这里要多说几句。网上有很多不是很准确的说法，经过本人的反复试验<code>node</code>处理<code>scripts</code>参数其实很简单，比如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;scripts&quot;: {
  &quot;serve&quot;: &quot;vue-cli-service serve&quot;,
  &quot;serve1&quot;: &quot;vue-cli-service --serve1&quot;,
  &quot;serve2&quot;: &quot;vue-cli-service -serve2&quot;,
  &quot;serve3&quot;: &quot;vue-cli-service serve --mode=dev --mobile -config build/example.js&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>除了第一个可执行的命令，以空格分割的任何字符串（除了一些shell的语法）都是参数，并且都能通过<code>process.argv</code>属性访问。</strong></p> <blockquote><p><code>process.argv</code>属性返回一个数组，这个数组包含了启动<code>node</code>进程时的命令行参数。第一个元素为启动<code>node</code>进程的可执行文件的绝对路径名<a href="http://nodejs.cn/api/process.html#process_process_execpath" target="_blank" rel="noopener noreferrer">process.execPath<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，第二个元素为当前执行的JavaScript文件路径。剩余的元素为其他命令行参数。</p></blockquote> <p>比如执行<code>npm run serve3</code>命令，<code>process.argv</code>的具体内容为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[ '/usr/local/Cellar/node/7.7.1_1/bin/node',
  '/Users/mac/Vue-projects/hao-cli/node_modules/.bin/vue-cli-service',
  'serve',
  '--mode=dev',
  '--mobile',
  '-config',
  'build/example.js']
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>很多命令行包之所以这么写，都是依赖了<a href="https://github.com/substack/minimist" target="_blank" rel="noopener noreferrer">minimist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 或者 <a href="https://github.com/yargs/yargs" target="_blank" rel="noopener noreferrer">yargs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 等参数解析工具来对命令行参数进行解析。</p> <p>以<code>minimist</code>对<code>vue-cli-service serve --mode=dev --mobile -config build/example.js</code>解析为例，解析后的结果为：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{ _: [ 'serve' ],
  mode: 'dev',
  mobile: true,
  config: 'build/example.js',
  '$0': '/Users/mac/Vue-projects/hao-cli/node_modules/.bin/vue-cli-service'}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在<code>./node_modules/.bin/vue-cli-service</code>文件中可以看到<code>minimist</code>对命令行参数的处理：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const rawArgv = process.argv.slice(2)
const args = require('minimist')(rawArgv, {
  boolean: [
    // build
    'modern',
    'report',
    'report-json',
    'watch',
    // serve
    'open',
    'copy',
    'https',
    // inspect
    'verbose'
  ]
})
const command = args._[0]
service.run(command, args, rawArgv).catch(err =&gt; {
  error(err)
  process.exit(1)
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>我们还可以通过命令行传参的形式来进行参数传递：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm run serve --params  // 参数params将转化成process.env.npm_config_params = true
npm run serve --params=123 // 参数params将转化成process.env.npm_config_params = 123
npm run serve -params  // 等同于--params参数

npm run serve -- --params  // 将--params参数添加到process.env.argv数组中
npm run serve params  // 将params参数添加到process.env.argv数组中
npm run serve -- params  // 将params参数添加到process.env.argv数组中
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="四、npm-配置"><a href="#四、npm-配置" aria-hidden="true" class="header-anchor">#</a> 四、npm 配置</h3> <p><code>npm</code>的配置操作可以帮助我们预先设定好<code>npm</code>对项目的行为动作，也可以让我们预先定义好一些配置项以供项目中使用。所以了解<code>npm</code>的配置机制也是很有必要。</p> <h4 id="_4-1-优先级"><a href="#_4-1-优先级" aria-hidden="true" class="header-anchor">#</a> 4.1 优先级</h4> <ul><li>命令行</li> <li>env 环境变量</li> <li>npmrc 文件</li> <li>默认配置</li></ul> <p><strong>命令行</strong></p> <p><strong>env 环境变量</strong></p> <p><strong>npmrc 文件</strong></p> <p><strong>默认配置</strong></p> <h4 id="_4-2-npm-config-指令"><a href="#_4-2-npm-config-指令" aria-hidden="true" class="header-anchor">#</a> 4.2 npm config 指令</h4> <ul><li>set</li> <li>get</li> <li>delete</li> <li>list</li> <li>edit</li></ul> <h3 id="五、npm-工程管理"><a href="#五、npm-工程管理" aria-hidden="true" class="header-anchor">#</a> 五、npm 工程管理</h3> <h3 id="六、npm-的几个实用技巧"><a href="#六、npm-的几个实用技巧" aria-hidden="true" class="header-anchor">#</a> 六、npm 的几个实用技巧</h3> <h3 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h3> <ul><li><a href="https://juejin.im/post/5d1d40ea6fb9a07eb94fa7df" target="_blank" rel="noopener noreferrer">13 个 npm 快速开发技巧<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5d08d3d3f265da1b7e103a4d" target="_blank" rel="noopener noreferrer">你所需要的 npm 知识储备都在这了<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5c44a2fbf265da610f63ff39" target="_blank" rel="noopener noreferrer">npm依赖：构建编译<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5c457d656fb9a04a0730af07" target="_blank" rel="noopener noreferrer">npm依赖：框架平台<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5c457e516fb9a049ec6b6341" target="_blank" rel="noopener noreferrer">npm依赖：类库工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="联系作者"><a href="#联系作者" aria-hidden="true" class="header-anchor">#</a> 联系作者</h2> <div align="center"><p>
        平凡世界，贵在坚持。
    </p> <img src="/about/contact.png"></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新于:</span> <span class="time">2018-12-20 17:30:58</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tool/npm-1.html" class="prev">私有npm仓库搭建</a></span> <span class="next"><a href="/tool/webhook.html">webhook</a>→
    </span></p></div> </main></div><div class="global-ui"><!----><!----><div></div></div></div>
    <script src="/assets/js/app.03e859c0.js" defer></script><script src="/assets/js/2.67134772.js" defer></script><script src="/assets/js/205.a35ec0ca.js" defer></script><script src="/assets/js/3.65dbdf4c.js" defer></script>
  </body>
</html>
